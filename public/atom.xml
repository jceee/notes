<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>This way up</title>
  <icon>https://www.gravatar.com/avatar/88a80c9c4a7711986c20dbd59bf0f0bf</icon>
  <subtitle>I am not perfect but I keep trying</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.jcsama.com/"/>
  <updated>2021-10-12T10:31:02.553Z</updated>
  <id>http://www.jcsama.com/</id>
  
  <author>
    <name>jceee</name>
    <email>jceee@foxmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>hexo gitpage 404</title>
    <link href="http://www.jcsama.com/2021/10/03/js/hexo/hexo-gitpage-404/"/>
    <id>http://www.jcsama.com/2021/10/03/js/hexo/hexo-gitpage-404/</id>
    <published>2021-10-03T13:30:20.000Z</published>
    <updated>2021-10-12T10:31:02.553Z</updated>
    
    <content type="html"><![CDATA[<h2 id="u4E00_u4E2A_u5947_u602A_u7684_u95EE_u9898"><a href="#u4E00_u4E2A_u5947_u602A_u7684_u95EE_u9898" class="headerlink" title="一个奇怪的问题"></a>一个奇怪的问题</h2><ul><li><p>Step 1 更新了一篇新的post;</p></li><li><p>Step 2 使用<code>hexo s</code>本地页面显示正常 ;</p></li><li><p>Step 3 使用<code>hexo g -d</code>命令执行正确;</p></li><li><p>Step 4 打开对应的Git page，发现404</p></li></ul><h2 id="u4E3A_u4EC0_u4E48_u4F1A_u51FA_u73B0"><a href="#u4E3A_u4EC0_u4E48_u4F1A_u51FA_u73B0" class="headerlink" title="为什么会出现"></a>为什么会出现</h2><ul><li>首先从最后环节开始排查，使用<code>hexo d --debug</code>查看部署是否有问题，没看到报错，把<code>.deploy_git</code>下的文件清理掉，重新跑几次也没解决</li><li>接着看部署问题，<code>hexo g --debug</code>，文件生成也正常，无报错</li><li>继续看生成的入口文件，发现<code>index.html</code>是空的，问题可能在这</li><li>搜索<code>hexo index.html empty</code> 这回找到别人也有一样的问题，找到问题：</li></ul><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"><span class="keyword">node</span> <span class="title">版本太高了，hexo</span> 还不支持</span><br></pre></td></tr></table></figure><h2 id="u89E3_u51B3"><a href="#u89E3_u51B3" class="headerlink" title="解决"></a>解决</h2><p>查看<code>hexo</code>版本：</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">hexo</span> <span class="string">-v</span>                                                                            </span><br><span class="line"><span class="attr">hexo:</span> <span class="number">3.9</span><span class="number">.0</span></span><br><span class="line"><span class="attr">hexo-cli:</span> <span class="number">4.3</span><span class="number">.0</span></span><br><span class="line"><span class="attr">os:</span> <span class="string">darwin</span> <span class="number">20.5</span><span class="number">.0</span> <span class="number">11.4</span></span><br></pre></td></tr></table></figure><p>参考<a href="https://hexo.io/news/2021/07/09/hexo-renderer-pug-2-0-0-hexo-cli-4-3-0-hexo-paginaiton-2-0-0-hexo-clean-css-2-0-0/" target="_blank" rel="noopener">hexo官网</a>推荐，支持的node版本是<code>8</code>以上或者<code>12</code></p><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">drop <span class="keyword">node</span> <span class="title">8</span> <span class="keyword">and</span> add <span class="keyword">node</span> <span class="title">12</span></span><br></pre></td></tr></table></figure><p>查看本地<code>node -v</code>:<code>v16.6.1</code>确实不符合，重新下载了<code>node12</code>，再部署解决～</p><h2 id="u540E_u8BB0"><a href="#u540E_u8BB0" class="headerlink" title="后记"></a>后记</h2><p>版本不兼容也没有提示，对使用者还是有些不友好，把错误都吞掉了</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;u4E00_u4E2A_u5947_u602A_u7684_u95EE_u9898&quot;&gt;&lt;a href=&quot;#u4E00_u4E2A_u5947_u602A_u7684_u95EE_u9898&quot; class=&quot;headerlink&quot; title=&quot;一个奇怪的问题&quot;&gt;&lt;
      
    
    </summary>
    
      <category term="node" scheme="http://www.jcsama.com/categories/node/"/>
    
    
      <category term="hexo" scheme="http://www.jcsama.com/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>一个环境引发的乱码问题</title>
    <link href="http://www.jcsama.com/2021/09/11/php/php_mysql_charset/"/>
    <id>http://www.jcsama.com/2021/09/11/php/php_mysql_charset/</id>
    <published>2021-09-11T10:13:00.000Z</published>
    <updated>2021-10-08T06:00:05.616Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p> 每个程序员多少都遇到过一些祖传代码，当代码能跑起来的时候并不可怕，可怕的是换了个环境，代码跑不起来了，这时脑里离不开这2个问题：”it can works ,why ?”  or  “it can`t works , why?”</p></blockquote><h2 id="u53D1_u73B0_u95EE_u9898"><a href="#u53D1_u73B0_u95EE_u9898" class="headerlink" title="发现问题"></a>发现问题</h2><p>有这一段代码，在服务器A中，从Mysql查出来的中文字段是正常显示的，从服务器B中显示的却是<code>???</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT * from m_user limit 10"</span>;</span><br><span class="line">$db = <span class="keyword">new</span> MySQLi($host, $user, $pwd, $dbname, $port);</span><br><span class="line">$result = $db-&gt;query($sql);</span><br><span class="line">$output = $result-&gt;fetch_assoc();</span><br><span class="line">$result-&gt;free();</span><br><span class="line">var_dump($output);</span><br></pre></td></tr></table></figure><h2 id="u4FEE_u590D_u95EE_u9898"><a href="#u4FEE_u590D_u95EE_u9898" class="headerlink" title="修复问题"></a>修复问题</h2><p><code>MySQLi</code>很少用，现在基本都是用<code>PDO</code>了，遇到这问题第一反应是查函数文档，是不是有些奇怪的环境设置。</p><p>查到<code>MySQLi</code>编码相关有<code>set_charset</code>函数，而mysql连接也有<code></code>SET NAMES {charset}`可以指定编码，在使用代码指定编码后服务器B也可以正常使用：</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$db = <span class="keyword">new</span> MySQLi($host, $user, $pwd, $dbname, $port);</span><br><span class="line">$db-&gt;set_charset(<span class="string">"utf8"</span>);</span><br><span class="line"><span class="comment">// or $db-&gt;query("set names utf8");</span></span><br><span class="line">$result = $db-&gt;query($sql);</span><br></pre></td></tr></table></figure><p>指定编码是可以正常查询，那么我们再通过<code>get_charset</code>，看看各自连接默认使用的编码：</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$db = <span class="keyword">new</span> MySQLi($host, $user, $pwd, $dbname, $port);</span><br><span class="line">var_dump($db-&gt;get_charset());</span><br></pre></td></tr></table></figure><p>发现正常的机器上使用的是<code>utf8</code>，乱码机器上的是<code>latin1</code></p><h2 id="u6392_u67E5_u95EE_u9898"><a href="#u6392_u67E5_u95EE_u9898" class="headerlink" title="排查问题"></a>排查问题</h2><p>我们发现问题在于php与mysql连接时，默认编码不一致，我们排查一下php与mysql的连接扩展有没有问题</p><p>通过<code>php -i</code> 命令查看mysql client使用的版本</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//默认utf8的机器:</span></span><br><span class="line">mysqli</span><br><span class="line">Client API library version =&gt; 5.5.19</span><br><span class="line">---------------------</span><br><span class="line"><span class="comment">//默认latin1的机器：</span></span><br><span class="line">mysqli</span><br><span class="line">Client API library version =&gt; 5.5.68-MariaDB</span><br></pre></td></tr></table></figure><p>通过对比，我们发现两者的版本并不一致，有问题的机器使用的是<code>MariaDB</code>，通过wifi百科发现这是个社区开发的，兼容mysql协议的开源数据库管理系统。</p><p><code>MariaDB</code>的API和协议兼容MySQL，使用是没有问题的，但<code>MariaDB</code>的默认编码是<code>latin1</code>，那这很可能就是问题根源。</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="keyword">In</span> MariaDB, the<span class="built_in"> default </span>character <span class="builtin-name">set</span> is latin1, <span class="keyword">and</span> the<span class="built_in"> default </span>collation is latin1_swedish_ci</span><br></pre></td></tr></table></figure><p>尝试修改php连接mysql的 Client API library，安装mysqlmysql_5.5.19 lib包，改原来使用包的软链，发现代码正常运行，问题解决～</p><h2 id="u540E_u8BB0"><a href="#u540E_u8BB0" class="headerlink" title="后记"></a>后记</h2><p>我们可以通过docker之类的工具，保持统一的环境，但从开发的解决还是尽量维护代码健壮性，通过代码指定连接使用的编码，这样换一个差不多的环境也能正常运行，可以少折腾一些环境</p><h2 id="u53C2_u8003"><a href="#u53C2_u8003" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="/MariaDB">MariaDB</a></li><li><a href="https://mariadb.com/kb/en/setting-character-sets-and-collations/" target="_blank" rel="noopener">MariaDb Default Charset</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt; 每个程序员多少都遇到过一些祖传代码，当代码能跑起来的时候并不可怕，可怕的是换了个环境，代码跑不起来了，这时脑里离不开这2个问题：”it can works ,why ?”  or  “it can`t works , why?”&lt;/p&gt;
&lt;/bl
      
    
    </summary>
    
      <category term="php" scheme="http://www.jcsama.com/categories/php/"/>
    
    
      <category term="php mysql" scheme="http://www.jcsama.com/tags/php-mysql/"/>
    
  </entry>
  
  <entry>
    <title>拆分Git仓库并保存提交记录</title>
    <link href="http://www.jcsama.com/2021/06/26/git/split-git-repository/"/>
    <id>http://www.jcsama.com/2021/06/26/git/split-git-repository/</id>
    <published>2021-06-26T14:48:38.000Z</published>
    <updated>2021-08-09T06:15:05.367Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>分分合合是常态，大项目有时会有拆分的需求，当想拆分git项目，又想保留提交记录时，可以按下面流程操作</p></blockquote><h2 id="u57FA_u672C_u8BBE_u5B9A"><a href="#u57FA_u672C_u8BBE_u5B9A" class="headerlink" title="基本设定"></a>基本设定</h2><p>父项目为 <code>https://github.com/xxx/demo.git</code></p><p>父仓库目录：/demo</p><p>当前子仓库目录：/demo/target_child</p><p>目标是把target_child拆到新项目：<code>https://github.com/xxx/target_child.git</code></p><h2 id="step1_clone__u4E00_u4EFD_u539F_u4ED3_u5E93_u6587_u4EF6_u5230_u672C_u5730_uFF0C_u76EE_u5F55_u4E3A_u76EE_u6807_u6587_u4EF6_u5939"><a href="#step1_clone__u4E00_u4EFD_u539F_u4ED3_u5E93_u6587_u4EF6_u5230_u672C_u5730_uFF0C_u76EE_u5F55_u4E3A_u76EE_u6807_u6587_u4EF6_u5939" class="headerlink" title="step1 clone 一份原仓库文件到本地，目录为目标文件夹"></a>step1 clone 一份原仓库文件到本地，目录为目标文件夹</h2><figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">​cd ~/git/code/</span><br><span class="line">​</span><br><span class="line">​git <span class="keyword">clone</span> <span class="title">https</span>://github.com/xxx/demo.git target_child</span><br><span class="line">​</span><br></pre></td></tr></table></figure><h2 id="step2__u5220_u6389_u539F_u4ED3_u5E93_u7684remote"><a href="#step2__u5220_u6389_u539F_u4ED3_u5E93_u7684remote" class="headerlink" title="step2 删掉原仓库的remote"></a>step2 删掉原仓库的remote</h2><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">cd</span> target_child</span><br><span class="line"></span><br><span class="line">git remote <span class="keyword">rm</span> origin</span><br></pre></td></tr></table></figure><h2 id="step3__u8FC7_u6EE4_u65E0_u7528_u7684_u5386_u53F2_u8BB0_u5F55"><a href="#step3__u8FC7_u6EE4_u65E0_u7528_u7684_u5386_u53F2_u8BB0_u5F55" class="headerlink" title="step3 过滤无用的历史记录"></a>step3 过滤无用的历史记录</h2><p>过滤所有历史提交，只保留对指定子目录有影响的提交. 命令执行完毕后，就可以看到本地的新仓库已经是原仓库子目录中的内容了，且保留了关于该子目录所有的提交历史。</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">git filter-branch --tag-name-filter cat --prune-empty --subdirectory-filter ./target_child -- --all</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>–tag-name-filter</td><td>该参数控制我们要如何处理旧的 tag，cat 即表示原样输出</td></tr><tr><td>–prune-empty</td><td>删除空的（对子目录没有影响的）提交</td></tr><tr><td>–subdirectory-filter</td><td>指定子目录路径, 如<code>./target_child</code></td></tr><tr><td>– –all</td><td>该参数必须跟在<code>--</code>后面，表示对所有分支进行操作。如果你只想保存当前分支，也可以不添加此参数。</td></tr></tbody></table><h2 id="step_4__u6E05_u7406-git_u7684object"><a href="#step_4__u6E05_u7406-git_u7684object" class="headerlink" title="step 4 清理.git的object"></a>step 4 清理.git的object</h2><p><code>.git</code> 目录里还是保存有不少无用的object，我们需要将其清除掉以减小新仓库的体积.</p><p>PS: <code>git gc</code>操作耗时比较久,请耐心等待.</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">git reset --hard</span><br><span class="line"></span><br><span class="line">git for-each-ref --format="%(refname)" refs/original/ |xargs -n 1 git update-ref -d</span><br><span class="line"></span><br><span class="line">git reflog expire --expire=now --all</span><br><span class="line"></span><br><span class="line">git gc --aggressive --prune=now</span><br></pre></td></tr></table></figure><h2 id="step_5__u5C06_u65B0_u7684_u672C_u5730_u4ED3_u5E93_u63A8_u9001_u5230_u8FDC_u7AEF"><a href="#step_5__u5C06_u65B0_u7684_u672C_u5730_u4ED3_u5E93_u63A8_u9001_u5230_u8FDC_u7AEF" class="headerlink" title="step 5 将新的本地仓库推送到远端"></a>step 5 将新的本地仓库推送到远端</h2><p>先创建新的仓库：<code>https://github.com/xxx/target_child.git</code></p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">//添加远端分支</span><br><span class="line"></span><br><span class="line">git remote add origin https://github.com/xxx/target_child.git</span><br><span class="line"></span><br><span class="line">//强制推送到远端</span><br><span class="line"></span><br><span class="line">git push --fore origin master</span><br></pre></td></tr></table></figure><p>PS:</p><p>若master分支为保护状态，强制推送时会遇到如下错误：</p><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">remote: GitLab: You are not allowed to force push code to a protected branch on this project.</span></span><br></pre></td></tr></table></figure><p>须解除master分支的保护状态，推完之后再改回来</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;分分合合是常态，大项目有时会有拆分的需求，当想拆分git项目，又想保留提交记录时，可以按下面流程操作&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u57FA_u672C_u8BBE_u5B9A&quot;&gt;&lt;a href=&quot;#u57FA_u672C_
      
    
    </summary>
    
      <category term="git" scheme="http://www.jcsama.com/categories/git/"/>
    
    
      <category term="git" scheme="http://www.jcsama.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>mysql abs func</title>
    <link href="http://www.jcsama.com/2021/06/10/mysql/mysql-abs/"/>
    <id>http://www.jcsama.com/2021/06/10/mysql/mysql-abs/</id>
    <published>2021-06-10T15:15:47.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ABS(<em>number</em>)</p><p>Return the absolute value of a number</p></blockquote><h2 id="u57FA_u672C_u7528_u6CD5"><a href="#u57FA_u672C_u7528_u6CD5" class="headerlink" title="基本用法"></a>基本用法</h2><p>返回数字参数的绝对值</p><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-243.5</span>);     ===&gt; 243.5</span><br></pre></td></tr></table></figure><h2 id="u65E0_u7B26_u53F7_u6570_u5B57_u76F8_u51CF_u8BA1_u7B97_u5F02_u5E38_u95EE_u9898"><a href="#u65E0_u7B26_u53F7_u6570_u5B57_u76F8_u51CF_u8BA1_u7B97_u5F02_u5E38_u95EE_u9898" class="headerlink" title="无符号数字相减计算异常问题"></a>无符号数字相减计算异常问题</h2><p>例子：创建用户表，年龄字段为非负</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `user` (</span><br><span class="line">  `uid` int(11) unsigned <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT COMMENT <span class="string">'uid'</span>,</span><br><span class="line">  `age` int(10) unsigned <span class="keyword">NOT</span> <span class="literal">NULL</span> COMMENT <span class="string">'年龄'</span>,</span><br><span class="line">  `name` varchar(50) <span class="keyword">NOT</span> <span class="literal">NULL</span><span class="built_in"> DEFAULT </span><span class="string">''</span> COMMENT <span class="string">'用户名'</span>,</span><br><span class="line">  PRIMARY KEY (`uid`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=InnoDB <span class="attribute">AUTO_INCREMENT</span>=1<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8mb4 COMMENT <span class="string">'用户表'</span>;</span><br></pre></td></tr></table></figure><p>写入几条测试数据</p><figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">INSERT</span> <span class="selector-tag">INTO</span> `<span class="selector-tag">user</span>` ( <span class="built_in">`age`</span>, <span class="built_in">`name`</span>)</span><br><span class="line"><span class="selector-tag">VALUES</span></span><br><span class="line">( <span class="number">11</span>, <span class="string">'张小明'</span>),</span><br><span class="line">( <span class="number">26</span>, <span class="string">'林小红'</span>),</span><br><span class="line">( <span class="number">21</span>, <span class="string">'李小狼'</span>),</span><br><span class="line">( <span class="number">18</span>, <span class="string">'陈小洋'</span>);</span><br></pre></td></tr></table></figure><p>当我们想找出年龄最接近25岁的用户时，会出现Mysql错误：</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">select *,ABS(age - 25) as age_sort <span class="keyword">from</span><span class="built_in"> user </span>order by age_sort asc limit 1;</span><br><span class="line">===&gt;BIGINT UNSIGNED value is out of range <span class="keyword">in</span> <span class="string">'(`user`.`age` - 25)'</span></span><br></pre></td></tr></table></figure><p>解决方法：使用cast把无符号age转为带符号的number</p><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> *,<span class="built_in">ABS</span>(<span class="keyword">CAST</span>(age <span class="keyword">AS</span> SIGNED) - <span class="number">25</span>) <span class="keyword">as</span> age_sort </span><br><span class="line"><span class="keyword">from</span> <span class="symbol">`user`</span> <span class="keyword">order</span> <span class="keyword">by</span> age_sort <span class="keyword">asc</span> <span class="keyword">limit</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ABS(&lt;em&gt;number&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;Return the absolute value of a number&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u57FA_u672C_u7528_u6CD5&quot;&gt;&lt;a href
      
    
    </summary>
    
      <category term="mysql" scheme="http://www.jcsama.com/categories/mysql/"/>
    
    
      <category term="mysql" scheme="http://www.jcsama.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>GO学习笔记--defer篇</title>
    <link href="http://www.jcsama.com/2019/04/23/golang/defer/"/>
    <id>http://www.jcsama.com/2019/04/23/golang/defer/</id>
    <published>2019-04-23T14:33:16.000Z</published>
    <updated>2021-08-09T06:15:05.367Z</updated>
    
    <content type="html"><![CDATA[<h1 id="u4EC0_u4E48_u662Fdefer"><a href="#u4EC0_u4E48_u662Fdefer" class="headerlink" title="什么是defer"></a>什么是defer</h1><h1 id="defer_u7279_u522B"><a href="#defer_u7279_u522B" class="headerlink" title="defer特别"></a>defer特别</h1><p>栈，后进先出</p><h1 id="u4EC0_u4E48_u573A_u666F_u4E0B_u7528defer"><a href="#u4EC0_u4E48_u573A_u666F_u4E0B_u7528defer" class="headerlink" title="什么场景下用defer"></a>什么场景下用defer</h1><p>程序员在编程的时候，经常需要打开一些资源，比如数据库连接、文件、锁等，这些资源需要在用完之后释放掉，否则会造成内存泄漏。</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span> <span class="params">()</span></span>&#123;</span><br><span class="line">f,err := os.Open(<span class="string">"test.txt"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Print(err, <span class="string">"\n"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Print(<span class="string">"do close \n"</span>)</span><br><span class="line">closeErr := f.Close()</span><br><span class="line"><span class="keyword">if</span> closeErr != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Print(<span class="string">"close file err \n"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">fmt.Print(<span class="string">"main end \n"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="defer_u539F_u7406"><a href="#defer_u539F_u7406" class="headerlink" title="defer原理"></a>defer原理</h1><p>每次defer语句执行的时候，会把函数“压栈”，函数参数会被拷贝下来；当外层函数（非代码块，如一个for循环）退出时，defer函数按照定义的逆序执行；如果defer执行的函数为nil, 那么会在最终调用函数的产生panic.<br>defer语句并不会马上执行，而是会进入一个栈，函数return前，会按先进后出的顺序执行。也说是说最先被定义的defer语句最后执行。先进后出的原因是后面定义的函数可能会依赖前面的资源，自然要先执行；否则，如果前面先执行，那后面函数的依赖就没有了。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;u4EC0_u4E48_u662Fdefer&quot;&gt;&lt;a href=&quot;#u4EC0_u4E48_u662Fdefer&quot; class=&quot;headerlink&quot; title=&quot;什么是defer&quot;&gt;&lt;/a&gt;什么是defer&lt;/h1&gt;&lt;h1 id=&quot;defer_u7279_u
      
    
    </summary>
    
      <category term="golang" scheme="http://www.jcsama.com/categories/golang/"/>
    
    
      <category term="golang" scheme="http://www.jcsama.com/tags/golang/"/>
    
      <category term="defer" scheme="http://www.jcsama.com/tags/defer/"/>
    
  </entry>
  
  <entry>
    <title>GO语言IDE篇--Vscode (Mac)</title>
    <link href="http://www.jcsama.com/2018/11/20/IDE/vscode/go-ide-vscode/"/>
    <id>http://www.jcsama.com/2018/11/20/IDE/vscode/go-ide-vscode/</id>
    <published>2018-11-20T15:26:46.000Z</published>
    <updated>2021-08-09T06:15:05.367Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>工欲善其事，必先利其器<br>—-《论语·卫灵公》</p></blockquote><h2 id="u524D_u8A00"><a href="#u524D_u8A00" class="headerlink" title="前言"></a>前言</h2><p>当我们开始学习一个编程语言时，第一步就是选择一款编码工具，我们使用工具的主要目的是提高我们的效率： </p><ul><li>语法高亮(基本都有)</li><li>支持DEBUG</li><li>插件丰富</li><li>集成终端</li><li>颜值（这个也很重要啊喂！）</li></ul><p>对比多款式工具后，jetbrains系列收费，LiteIDE略丑，Vim学习曲线高…最后我选择了满足了我的所有要求的Vscode，下面开始撸之～</p><h2 id="u5B89_u88C5GO_u73AF_u5883"><a href="#u5B89_u88C5GO_u73AF_u5883" class="headerlink" title="安装GO环境"></a>安装GO环境</h2><p>这里假设我们已经安装完基础环境并配置好了环境变量，略过…</p><h2 id="u5B89_u88C5vscode"><a href="#u5B89_u88C5vscode" class="headerlink" title="安装vscode"></a>安装vscode</h2><p><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">vscode官网</a>下之</p><h2 id="u5B89_u88C5go_u63D2_u4EF6"><a href="#u5B89_u88C5go_u63D2_u4EF6" class="headerlink" title="安装go插件"></a>安装go插件</h2><h3 id="u57FA_u7840_u63D2_u4EF6"><a href="#u57FA_u7840_u63D2_u4EF6" class="headerlink" title="基础插件"></a>基础插件</h3><p>打开vscode，打开插件搜索，输入go，安装之:<br><img src="/images/go-vscode/go-extend.png" alt="插件安装"></p><h3 id="u5B89_u88C5_u4F9D_u8D56_u5305_u652F_u6301"><a href="#u5B89_u88C5_u4F9D_u8D56_u5305_u652F_u6301" class="headerlink" title="安装依赖包支持"></a>安装依赖包支持</h3><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">mkdir</span> -<span class="keyword">p</span> $GOPAH/src/golang.org/<span class="keyword">x</span></span><br><span class="line">$ <span class="keyword">cd</span> $GOPAH/src/golang.org/<span class="keyword">x</span></span><br><span class="line">$ git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/golang/tools.git tools</span><br><span class="line"></span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span>  github.<span class="keyword">com</span>/ramya-rao-<span class="keyword">a</span>/<span class="keyword">go</span>-outline</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span>  github.<span class="keyword">com</span>/acroca/<span class="keyword">go</span>-symbols</span><br><span class="line">$ <span class="keyword">go</span> install golang.org/<span class="keyword">x</span>/tools/cmd/guru</span><br><span class="line">$ <span class="keyword">go</span> install golang.org/<span class="keyword">x</span>/tools/cmd/gorename</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> github.<span class="keyword">com</span>/rogpeppe/godef</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> github.<span class="keyword">com</span>/sqs/goreturns</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> github.<span class="keyword">com</span>/ramya-rao-<span class="keyword">a</span>/<span class="keyword">go</span>-outline</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> github.<span class="keyword">com</span>/josharian/impl</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> golang.org/<span class="keyword">x</span>/lint/golint</span><br><span class="line">$ <span class="keyword">go</span> <span class="built_in">get</span> -<span class="keyword">u</span> github.<span class="keyword">com</span>/cweill/gotests/gotests</span><br></pre></td></tr></table></figure><h3 id="u5B89_u88C5dlv"><a href="#u5B89_u88C5dlv" class="headerlink" title="安装dlv"></a>安装dlv</h3><p>go的debug依赖于dlv</p><p>安装dlv有2种途径:</p><h4 id="brew_u5B89_u88C5dlv"><a href="#brew_u5B89_u88C5dlv" class="headerlink" title="brew安装dlv"></a>brew安装dlv</h4><p>这个帮你解决了证书等问题</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$ brew <span class="keyword">install</span> <span class="keyword">go</span>-delve/delve/delve</span><br></pre></td></tr></table></figure><h4 id="go_get_u5B89_u88C5dlv"><a href="#go_get_u5B89_u88C5dlv" class="headerlink" title="go get安装dlv"></a>go get安装dlv</h4><p>安装dlv</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ go get github.com<span class="regexp">/derekparker/</span>delve<span class="regexp">/cmd/</span>dlv</span><br><span class="line"></span><br><span class="line">-- 查看是否安装成功</span><br><span class="line">$ <span class="variable">$GOPATH</span><span class="regexp">/bin/</span>dlv version</span><br></pre></td></tr></table></figure><p>把dlv从<code>GOPATH</code>移动到<code>GOROOT</code></p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ sudo mv <span class="variable">$GOPATH</span><span class="regexp">/bin/</span>dlv <span class="variable">$GOROOT</span><span class="regexp">/bin/</span>dlv</span><br></pre></td></tr></table></figure><p>创建系统证书</p><figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">1 </span>打开<span class="string">"钥匙串访问"</span></span><br><span class="line"><span class="symbol">2 </span>打开菜单 钥匙串访问/证书助理/创建证书...</span><br><span class="line"><span class="symbol">3 </span>名称: dlv-cert 身份类型: 自签名证书 证书类型: 代码签名 并 选择<span class="string">"让我覆盖这些默认值"</span></span><br><span class="line"><span class="symbol">4 </span>单击<span class="string">"继续"</span>, 有效期(天数): <span class="number">365</span> 这里你可以自己修改, 我改为<span class="number">3650</span></span><br><span class="line"><span class="symbol">5 </span>一路继续下去, 直到看到<span class="string">"指定用于该证书的位置"</span> 钥匙串 选择 <span class="string">"系统"</span> 并单击<span class="string">"创建"</span>按钮</span><br><span class="line"><span class="symbol">6 </span>重启系统之后, 再打开<span class="string">"钥匙串访问"</span>, 选择<span class="string">"系统"</span>, 就会看到创建好的<span class="string">"dlv-cert"</span>证书.</span><br><span class="line"><span class="symbol">7 </span>右键<span class="string">"dlv-cert"</span>证书, 选择<span class="string">"显示简介"</span>-&gt;<span class="string">"信任"</span>-&gt;<span class="string">"代码签名"</span> 修改为: 始终信任</span><br></pre></td></tr></table></figure><p>分配证书</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ sudo codesign -s <span class="string">"dlv-cert"</span> <span class="variable">$GOROOT</span><span class="regexp">/bin/</span>dlv</span><br></pre></td></tr></table></figure><p>如果调试时遇到下面问题：</p><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">could<span class="built_in"> not </span>launch process: debugserver<span class="built_in"> or </span>lldb-server<span class="built_in"> not </span>found: install XCode's command line tools<span class="built_in"> or </span>lldb-server</span><br></pre></td></tr></table></figure><p>可以安装一下xcode-select:</p><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">xcode-<span class="keyword">select</span> <span class="comment">--install</span></span><br></pre></td></tr></table></figure><h2 id="u5F00_u59CB_u8C03_u8BD5"><a href="#u5F00_u59CB_u8C03_u8BD5" class="headerlink" title="开始调试"></a>开始调试</h2><p>创建个必写的hello world文件：</p><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> h <span class="keyword">string</span> = <span class="string">"こんにちは"</span></span><br><span class="line"><span class="keyword">var</span> w <span class="keyword">string</span> = <span class="string">"世界"</span></span><br><span class="line">fmt.Println(h, w)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后开始debug<br><img src="/images/go-vscode/start-debug.png" alt="开始debug"></p><p>如果是第一次调试，会让你编辑launch.json文件</p><p>我们加一个配置：<br><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"helloword"</span>,</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"go"</span>,</span><br><span class="line">    <span class="attr">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">    <span class="attr">"mode"</span>: <span class="string">"debug"</span>,</span><br><span class="line">    <span class="attr">"env"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"program"</span>: <span class="string">"$&#123;workspaceRoot&#125;/hello/helloworld.go"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>program是调试文件的地址，${workspaceRoot}是项目的根目录，根据实际情况改</p><p>保存，再跑一下debug：<br><img src="/images/go-vscode/debug.png" alt="开始debug"></p><p>这样就完成了～</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;工欲善其事，必先利其器&lt;br&gt;—-《论语·卫灵公》&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u524D_u8A00&quot;&gt;&lt;a href=&quot;#u524D_u8A00&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言
      
    
    </summary>
    
    
      <category term="go" scheme="http://www.jcsama.com/tags/go/"/>
    
      <category term="ide" scheme="http://www.jcsama.com/tags/ide/"/>
    
  </entry>
  
  <entry>
    <title>java学习笔记[bean注解]</title>
    <link href="http://www.jcsama.com/2018/03/30/java/java-bean/"/>
    <id>http://www.jcsama.com/2018/03/30/java/java-bean/</id>
    <published>2018-03-30T14:22:53.000Z</published>
    <updated>2021-08-09T06:15:05.367Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>java的注解可以实现很多功能，如类的声明，属性声明，注入声明，配置…等等，这里对其作用做了笔记</p></blockquote><h1 id="Bean_u7684_u58F0_u660E"><a href="#Bean_u7684_u58F0_u660E" class="headerlink" title="Bean的声明"></a>Bean的声明</h1><ul><li>@Component 通用，无明确角色</li><li>@Repository. 数据访问层（Dao）层注解</li><li>@Controller  Controller层</li><li>@Service  业务逻辑Service层</li><li>@Configuration 配置文件</li></ul><h1 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h1><h2 id="u4F5C_u7528_u57DF_u7C7B_u578B"><a href="#u4F5C_u7528_u57DF_u7C7B_u578B" class="headerlink" title="作用域类型"></a>作用域类型</h2><p>@Scope(“single”)    </p><ul><li>single          每个IOC容器对一个bean定义创建唯一实例 </li><li>prototype    对一个bean定义，每次请求容器都会创建新的实例 </li><li>session         对一个bean定义，一次web会话创建一个实例 </li><li>request            对一个bean定义，一次web请求会创建一个实例 </li><li>global session    对一个bean定义，一次porlet会话创建一个实例 </li></ul><h2 id="u4EE3_u7406"><a href="#u4EE3_u7406" class="headerlink" title="代理"></a>代理</h2><p>scoped-proxy的意义在关联bean之间的依赖<br>proxy，它代理的工作就是——暴露这个bean时令其符合其作用域的特性。</p><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Scope(proxyMode = ScopedProxyMode.TARGET_CLASS)</span></span><br></pre></td></tr></table></figure><p>能够在HTTP request或者Session（甚至自定义）作用域中定义bean固然很好，但是Spring IoC容器除了管理对象（bean）的实例化，同时还负责协作者（或者叫依赖）的实例化。<br>如果你打算将一个Http request范围的bean注入到另一个bean中，那么需要注入一个AOP代理来替代被注入的作用域bean。<br>也就是说，你需要注入一个代理对象，该对象具有与被代理对象一样的公共接口，而容器则可以足够智能的从相关作用域中（比如一个HTTP request）获取到真实的目标对象，并把方法调用委派给实际的对象。</p><p>proxyMode：代理方式</p><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">取值说明：  </span><br><span class="line"><span class="keyword">ScopedProxyMode.DEFAULT: </span>          默认  </span><br><span class="line"><span class="keyword">ScopedProxyMode.NO: </span>               不使用代理</span><br><span class="line"><span class="keyword">ScopedProxyMode.INTERFACES: </span>       接口    ---<span class="keyword">jdk动态代理</span></span><br><span class="line"><span class="keyword">ScopedProxyMode.TARGET_CLASS: </span>     类      ---cglib</span><br></pre></td></tr></table></figure><h1 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h1><p>@Bean<br>配置Bean</p><h1 id="Bean_u7684_u6CE8_u5165"><a href="#Bean_u7684_u6CE8_u5165" class="headerlink" title="Bean的注入"></a>Bean的注入</h1><ul><li>@Autowired          Spring 提供的注解 .    (required=false)非必要注入，找不到不会报错</li><li>@Resource           JSR-250提供的注解.    </li><li>@Inject                JSR-330提供的注解</li></ul><h2 id="u533A_u522B"><a href="#u533A_u522B" class="headerlink" title="区别"></a>区别</h2><p>‘@Autowired’和‘@Inject’这两个注解行为完全相同，都是通过AutowiredAnnotation的BeanPostProcessor来实现依赖注入。也就是说，在注入Spring bean的时候‘Autowired’和‘@Inject’可以互换。</p><p>而‘@Resource’使用CommonAnnotationBeanPostProcessor来实现注入。虽然它使用的注入处理类不一样，但是其实所有这三个注解行为几乎一样。</p><p>下面是它们执行逻辑顺序的总结：</p><p><code>@Autowired和@Inject</code></p><p>按照类型匹配<br>使用限定符进行类型限定<br>按照名称匹配</p><p><code>@Resource</code></p><p>按照名称匹配<br>按照类型匹配<br>使用限定符进行类型限定（但如果名称匹配成功的话这条会被忽略）</p><p>Ps: 使用@Inject需要Jsr-303的支持，添加依赖</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.inject<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.inject<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="List_2CMap_u7684_u6CE8_u5165"><a href="#List_2CMap_u7684_u6CE8_u5165" class="headerlink" title="List,Map的注入"></a>List,Map的注入</h1><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span></span>&#123;</span><br><span class="line">    @Autowired</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">List</span>&lt;Bean&gt; <span class="keyword">list</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Qualifier"><a href="#Qualifier" class="headerlink" title="Qualifier"></a>Qualifier</h2><p>限定符</p><h1 id="Required"><a href="#Required" class="headerlink" title="Required"></a>Required</h1><p>@Required注解适用于bean属性的setter方法并且它指示，受影响的bean属性必须在配置时被填充在XML配置文件中，否则容器将抛出BeanInitializationException例外。</p><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span>&#123;</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> name;</span><br><span class="line"></span><br><span class="line">    @Required</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(<span class="keyword">String</span> name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Class Demo2 &#123;</span><br><span class="line">    @Autowired(value=<span class="string">"name"</span>)</span><br><span class="line">    <span class="keyword">private</span> Demo demo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Meta-annotations_u5143_u6CE8_u89E3"><a href="#Meta-annotations_u5143_u6CE8_u89E3" class="headerlink" title="Meta-annotations元注解"></a>Meta-annotations元注解</h1><ul><li><p>@Retention：</p><p>可以设置三种值RetentionPolicy.CLASS、RentionPolicy.RUNTIME、RentionPolicy.SOURCE，表明描述注解的生命周期，即注解的生效范围，分别是：<br> 1.SOURCE：在源文件中生效，仅存在java文件中，class文件将会去除注解。</p><p> 2.CLASS：在class文件中生效，仅保留在class文件中，运行时无法获取注解。</p><p> 3.RUNTIME:在运行时生效，保留在class文件中且运行时可通过反射机制获取。</p></li><li><p>@Target：</p><p>表示该新定义Annotation的作用目标，具体可参考API文档。<br>  1.CONSTRUCTOR:用于描述构造器</p><p>  2.FIELD:用于描述域（成员变量）</p><p>  3.LOCAL_VARIABLE:用于描述局部变量</p><p>  4.METHOD:用于描述方法</p><p>  5.PACKAGE:用于描述包</p><p>  6.PARAMETER:用于描述参数</p><p>  7.TYPE:用于描述类、接口(包括注解类型) 或enum声明</p></li><li><p>@Documented</p><p>表示该新定义Annotation是否保留在Java Docs中。</p></li><li><p>@Inherited</p><p>表示使用该新定义Annotation可以继承。</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;java的注解可以实现很多功能，如类的声明，属性声明，注入声明，配置…等等，这里对其作用做了笔记&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;Bean_u7684_u58F0_u660E&quot;&gt;&lt;a href=&quot;#Bean_u7684_u58F
      
    
    </summary>
    
      <category term="java" scheme="http://www.jcsama.com/categories/java/"/>
    
    
      <category term="java" scheme="http://www.jcsama.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>php-config</title>
    <link href="http://www.jcsama.com/2016/10/14/php/php-config/"/>
    <id>http://www.jcsama.com/2016/10/14/php/php-config/</id>
    <published>2016-10-14T09:39:00.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>php配置</p></blockquote><h1 id="PHP_config"><a href="#PHP_config" class="headerlink" title="PHP config"></a>PHP config</h1><h2 id="u9690_u85CFphp_u7248_u672C_u53F7"><a href="#u9690_u85CFphp_u7248_u672C_u53F7" class="headerlink" title="隐藏php版本号"></a>隐藏php版本号</h2><p>通常没经验修改配置的php服务，在请求结束时返回的Response头中会带有php的版本信息，如：</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cache</span>-control:<span class="keyword">no</span>-<span class="keyword">cache</span></span><br><span class="line"><span class="keyword">Connection</span>:<span class="keyword">keep</span>-alive</span><br><span class="line"><span class="keyword">Content</span>-<span class="keyword">Type</span>:<span class="built_in">text</span>/html; charset=UTF-8</span><br><span class="line">date:Fri, 14 Oct 2016 09:44:22 GMT</span><br><span class="line">Server:nginx</span><br><span class="line">Transfer-Encoding:chunked</span><br><span class="line">X-Powered-By:PHP/5.6.16</span><br></pre></td></tr></table></figure><p>我们想隐藏掉<code>X-Powered-By:PHP/5.6.16</code>只需修改一个地方：php.ini中的<code>expose_php</code>,把<code>On</code>改为<code>Off</code>即可</p><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">expose_php</span> = <span class="literal">Off</span></span><br></pre></td></tr></table></figure><p>效果如下</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cache</span>-control:<span class="keyword">no</span>-<span class="keyword">cache</span></span><br><span class="line"><span class="keyword">Connection</span>:<span class="keyword">keep</span>-alive</span><br><span class="line"><span class="keyword">Content</span>-<span class="keyword">Type</span>:<span class="built_in">text</span>/html; charset=UTF-8</span><br><span class="line">date:Fri, 14 Oct 2016 09:46:31 GMT</span><br><span class="line">Server:nginx</span><br><span class="line">Transfer-Encoding:chunked</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;php配置&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;PHP_config&quot;&gt;&lt;a href=&quot;#PHP_config&quot; class=&quot;headerlink&quot; title=&quot;PHP config&quot;&gt;&lt;/a&gt;PHP config&lt;/h1&gt;&lt;
      
    
    </summary>
    
      <category term="php" scheme="http://www.jcsama.com/categories/php/"/>
    
    
      <category term="php" scheme="http://www.jcsama.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>linux-find</title>
    <link href="http://www.jcsama.com/2016/07/04/linux/linux-find/"/>
    <id>http://www.jcsama.com/2016/07/04/linux/linux-find/</id>
    <published>2016-07-04T07:02:12.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>find是linux 命令，它将档案系统内符合 expression 的档案列出来。你可以指要档案的名称、类别、时间、大小、权限等不同资讯的组合，只有完全相符的才会被列出来。</p></blockquote><h2 id="u8BED_u6CD5"><a href="#u8BED_u6CD5" class="headerlink" title="语法"></a>语法</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ <span class="builtin-name">find</span> path -option [ -<span class="builtin-name">print</span> ] [ -exec -ok command ] &#123;&#125; \;</span><br></pre></td></tr></table></figure><p>下边列举常用的一些条件</p><h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><p>查找单个目录：</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ <span class="builtin-name">find</span> /tmp</span><br></pre></td></tr></table></figure><p>查找多个目录:</p><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">$ find <span class="string">/tmp</span> <span class="string">/opt</span> <span class="string">/etc</span></span><br></pre></td></tr></table></figure><h2 id="option"><a href="#option" class="headerlink" title="option"></a>option</h2><h3 id="u6309_u6863_u6848_u540D"><a href="#u6309_u6863_u6848_u540D" class="headerlink" title="按档案名"></a>按档案名</h3><p>查找后缀为<code>.md</code> 的档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -name "*.<span class="built_in">md</span>"</span><br></pre></td></tr></table></figure><p>查找后缀为<code>.md</code>的档案，并不区分大小写(可以是<code>.MD</code>,<code>.Md</code>,<code>.mD</code>)</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -iname "*.<span class="built_in">md</span>"</span><br></pre></td></tr></table></figure><h3 id="u6309_u6863_u6848_u7C7B_u578B"><a href="#u6309_u6863_u6848_u7C7B_u578B" class="headerlink" title="按档案类型"></a>按档案类型</h3><p>文件夹</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> d</span><br></pre></td></tr></table></figure><p>符号连接</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> l</span><br></pre></td></tr></table></figure><p>一般档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> f</span><br></pre></td></tr></table></figure><p>字形装置</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> c</span><br></pre></td></tr></table></figure><p>区块装置</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> b</span><br></pre></td></tr></table></figure><p>具名贮列</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> p</span><br></pre></td></tr></table></figure><p>socket</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">type</span> s</span><br></pre></td></tr></table></figure><h3 id="u65F6_u95F4"><a href="#u65F6_u95F4" class="headerlink" title="时间"></a>时间</h3><p>类型</p><ul><li>a (access) 访问时间</li><li>c (change) 状态改变时间(如修改,chmod,chown)</li><li>m (modification) 修改时间</li></ul><p>单位</p><ul><li>min 以分钟为单位  </li><li>time 以天为单位  </li></ul><p>量</p><ul><li>-n  在n单位时间内  </li><li>+n  在n单位时间前  </li><li>n   在n单位时间中  </li></ul><p>在n分钟前被访问|修改|改变过的档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -amin +n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -mmin +n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -cmin +n</span><br></pre></td></tr></table></figure><p>在n分钟内被访问|修改|改变过的档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -amin -n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -mmin -n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -cmin -n</span><br></pre></td></tr></table></figure><p>在前n分钟被访问|修改|改变过的档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -amin n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -mmin n</span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -cmin n</span><br></pre></td></tr></table></figure><p>最近[n天内|n天前|前n天]被访问|修改|改变过的档案</p><figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> path -atime [-<span class="built_in">n</span>|+<span class="built_in">n</span>|<span class="built_in">n</span>]</span><br><span class="line">$ <span class="built_in">find</span> path -mtime [-<span class="built_in">n</span>|+<span class="built_in">n</span>|<span class="built_in">n</span>]</span><br><span class="line">$ <span class="built_in">find</span> path -ctime [-<span class="built_in">n</span>|+<span class="built_in">n</span>|<span class="built_in">n</span>]</span><br></pre></td></tr></table></figure><p>比file档案更晚被访问|修改|改变过的档案</p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">find</span> path -anewer <span class="keyword">file</span></span><br><span class="line">$ <span class="keyword">find</span> path -mnewer <span class="keyword">file</span></span><br><span class="line">$ <span class="keyword">find</span> path -<span class="keyword">cnewer</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure><h3 id="u8DEF_u5F84"><a href="#u8DEF_u5F84" class="headerlink" title="路径"></a>路径</h3><p>路径中含有path</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -<span class="built_in">path</span> "*<span class="built_in">path</span>*"</span><br></pre></td></tr></table></figure><p>路径含有path并不区分大小写</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -ipath "*<span class="built_in">PATH</span>*"</span><br></pre></td></tr></table></figure><h3 id="u5927_u5C0F"><a href="#u5927_u5C0F" class="headerlink" title="大小"></a>大小</h3><p>查找大于nk,小于nk的档案</p><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> path -<span class="built_in">size</span> +nk</span><br><span class="line">$ <span class="built_in">find</span> path -<span class="built_in">size</span> -nk</span><br></pre></td></tr></table></figure><p>空档案</p><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -empty</span><br></pre></td></tr></table></figure><h3 id="u6743_u9650"><a href="#u6743_u9650" class="headerlink" title="权限"></a>权限</h3><p>mode的值 对应3种用户(所属用户，所属组，其他)的rwx权限 </p><ul><li>-mode 3种用户的权限都跟mode值对上，则成功（如644对444|644）</li><li>+mode 3种用户的权限只要有一个对上，则成功（如644能对622等）</li><li>mode 3种用户的权限都要跟mode准确对上才成功（如222对222）</li></ul><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -perm -<span class="built_in">mode</span></span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -perm +<span class="built_in">mode</span></span><br><span class="line">$ <span class="built_in">find</span> <span class="built_in">path</span> -perm <span class="built_in">mode</span></span><br></pre></td></tr></table></figure><h2 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h2><p>需要对搜索结果执行shell命令则用<code>-exec</code>,如</p><figure class="highlight elm"><table><tr><td class="code"><pre><span class="line">$ find / -<span class="keyword">type</span> f -exec ls -lah &#123;&#125; \;</span><br></pre></td></tr></table></figure><h2 id="example"><a href="#example" class="headerlink" title="example"></a>example</h2><p>把小于2k的文件搬到/tmp目录</p><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">$ <span class="built_in">find</span> path -<span class="built_in">size</span> <span class="number">-2</span>k -exec mv &#123;&#125; /tmp \;</span><br></pre></td></tr></table></figure><p>找出档案名含有’abc’ 的普通档案</p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">find</span> path -name <span class="string">'*abc*'</span> -<span class="built_in">type</span> <span class="keyword">f</span> </span><br><span class="line">$ <span class="keyword">find</span> -<span class="built_in">type</span> <span class="keyword">f</span> | <span class="keyword">grep</span> <span class="keyword">abc</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;find是linux 命令，它将档案系统内符合 expression 的档案列出来。你可以指要档案的名称、类别、时间、大小、权限等不同资讯的组合，只有完全相符的才会被列出来。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u8BED_u6CD
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>linux-nohup</title>
    <link href="http://www.jcsama.com/2016/07/02/linux/linux-nohup/"/>
    <id>http://www.jcsama.com/2016/07/02/linux/linux-nohup/</id>
    <published>2016-07-02T09:33:25.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>nohup(no hang up) 即不挂机，在关闭终端或退出账户时，仍不关闭进程</p></blockquote><h2 id="u529F_u80FD"><a href="#u529F_u80FD" class="headerlink" title="功能"></a>功能</h2><p>nohup 命令运行由 Command参数和任何相关的 Arg参数指定的命令，忽略所有挂断（SIGHUP）信号。在注销后使用 nohup 命令运行后台中的程序。要运行后台中的 nohup 命令，添加 &amp; （ 表示“and”的符号）到命令的尾部。<br>如果不将 nohup 命令的输出重定向，输出将附加到当前目录的 <code>nohup.out</code> 文件中。如果当前目录的 nohup.out 文件不可写，输出重定向到 <code>$HOME/nohup.out</code> 文件中。如果没有文件能创建或打开以用于追加，那么 Command 参数指定的命令不可调用。如果标准错误是一个终端，那么把指定的命令写给标准错误的所有输出作为标准输出重定向到相同的文件描述符。</p><h2 id="u8BED_u6CD5"><a href="#u8BED_u6CD5" class="headerlink" title="语法"></a>语法</h2><figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">$ nohup Command <span class="comment">[ Arg ... ]</span> <span class="comment">[　&amp; ]</span></span><br></pre></td></tr></table></figure><p>example:</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">$ nohup php <span class="keyword">test</span>.php &amp;</span><br><span class="line">$ nohup php <span class="keyword">test</span>.php &gt;~/<span class="keyword">outFile</span>.<span class="keyword">out</span> 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><ul><li>0 – stdin (standard input)</li><li>1 – stdout (standard output)</li><li>2 – stderr (standard error)  </li></ul><p>2&gt;&amp;1是将标准错误（2）重定向到标准输出（&amp;1），标准输出（&amp;1）再被重定向输入到myout.file文件中。</p><h2 id="u67E5_u770B_u4EFB_u52A1_u5217_u8868"><a href="#u67E5_u770B_u4EFB_u52A1_u5217_u8868" class="headerlink" title="查看任务列表"></a>查看任务列表</h2><p>用<code>jobs</code>可以看到正在运行的任务</p><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">$ jobs                                                                                                                   </span><br><span class="line">[<span class="number">1</span>]  + running    nohup php test.php &gt; ~/outFile.out <span class="number">2</span>&gt;&amp;<span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="u5173_u95ED_u4EFB_u52A1"><a href="#u5173_u95ED_u4EFB_u52A1" class="headerlink" title="关闭任务"></a>关闭任务</h2><p>n为任务号</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">fg</span> %n</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;nohup(no hang up) 即不挂机，在关闭终端或退出账户时，仍不关闭进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u529F_u80FD&quot;&gt;&lt;a href=&quot;#u529F_u80FD&quot; class=&quot;headerlink&quot; t
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu下配置lnmp</title>
    <link href="http://www.jcsama.com/2016/06/19/linux/linux-lnmp/"/>
    <id>http://www.jcsama.com/2016/06/19/linux/linux-lnmp/</id>
    <published>2016-06-19T14:10:25.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>环境：Ubuntu Linux 14.04</p></blockquote><h1 id="u5B89_u88C5_u8F6F_u4EF6_u4ED3_u5E93_u7BA1_u7406_u5668"><a href="#u5B89_u88C5_u8F6F_u4EF6_u4ED3_u5E93_u7BA1_u7406_u5668" class="headerlink" title="安装软件仓库管理器"></a>安装软件仓库管理器</h1><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">$ sudo apt-<span class="built_in">get</span> install python-software-<span class="built_in">properties</span>;</span><br></pre></td></tr></table></figure><h1 id="u5B89_u88C5PHP"><a href="#u5B89_u88C5PHP" class="headerlink" title="安装PHP"></a>安装PHP</h1><h2 id="u5B89_u88C5php_u53CA_u6269_u5C55"><a href="#u5B89_u88C5php_u53CA_u6269_u5C55" class="headerlink" title="安装php及扩展"></a>安装php及扩展</h2><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">$ sudo apt-get install python-software-properties;</span><br><span class="line">$ sudo<span class="built_in"> add-apt-repository </span>ppa:ondrej/php5-5.6;</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install php5-fpm php5-cli php5-curl php5-gd php5-json php5-mcrypt php5-mysqlnd php5-memcache php5-redis php5-xdebug;</span><br></pre></td></tr></table></figure><p>查看版本信息</p><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">   $ php5-fpm -vPHP <span class="number">5.6</span><span class="number">.22</span><span class="number">-1</span>+donate.sury.org~trusty+<span class="number">1</span> (fpm-fcgi)Copyright (c) <span class="number">1997</span><span class="number">-2016</span> The PHP GroupZend Engine v2<span class="number">.6</span><span class="number">.0</span>, Copyright (c) <span class="number">1998</span><span class="number">-2016</span> Zend Technologies    with Zend OPcache v7<span class="number">.0</span><span class="number">.6</span>-dev, Copyright (c) <span class="number">1999</span><span class="number">-2016</span>, by Zend Technologies    with Xdebug v2<span class="number">.3</span><span class="number">.3</span>, Copyright (c) <span class="number">2002</span><span class="number">-2015</span>, by Derick Rethans</span><br></pre></td></tr></table></figure><h2 id="u5E38_u7528_u547D_u4EE4"><a href="#u5E38_u7528_u547D_u4EE4" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="u5173_u95ED_uFF0C_u5F00_u542F_uFF0C_u91CD_u542F"><a href="#u5173_u95ED_uFF0C_u5F00_u542F_uFF0C_u91CD_u542F" class="headerlink" title="关闭，开启，重启"></a>关闭，开启，重启</h3><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ sudo<span class="built_in"> service </span>php5-fpm stop </span><br><span class="line">$ sudo<span class="built_in"> service </span>php5-fpm start</span><br><span class="line">$ sudo<span class="built_in"> service </span>php5-fpm restart</span><br></pre></td></tr></table></figure><h2 id="u5B89_u88C5composer"><a href="#u5B89_u88C5composer" class="headerlink" title="安装composer"></a>安装composer</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>sudo apt-get install curl</span><br><span class="line"><span class="variable">$ </span>sudo curl -sS <span class="symbol">https:</span>/<span class="regexp">/getcomposer.org/installer</span> | php</span><br><span class="line"><span class="variable">$ </span>sudo mv composer.phar /usr/local/bin/composer</span><br></pre></td></tr></table></figure><h1 id="u5B89_u88C5Nginx"><a href="#u5B89_u88C5Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h1><h2 id="u5B89_u88C5Nginx-1"><a href="#u5B89_u88C5Nginx-1" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">$ sudo<span class="built_in"> add-apt-repository </span>ppa:nginx/stable;</span><br><span class="line">$ sudo apt-get update;</span><br><span class="line">$ sudo apt-get install nginx;</span><br></pre></td></tr></table></figure><p>查看版本信息</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>sudo nginx -v</span><br></pre></td></tr></table></figure><h2 id="u5E38_u7528_u547D_u4EE4-1"><a href="#u5E38_u7528_u547D_u4EE4-1" class="headerlink" title="常用命令"></a>常用命令</h2><p>启动 ，关闭，重启，配置重载</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ sudo<span class="built_in"> service </span>nginx start</span><br><span class="line">$ sudo<span class="built_in"> service </span>nginx stop</span><br><span class="line">$ sudo<span class="built_in"> service </span>nginx restart</span><br><span class="line">$ sudo<span class="built_in"> service </span>nginx reload</span><br></pre></td></tr></table></figure><h1 id="u5B89_u88C5mysql"><a href="#u5B89_u88C5mysql" class="headerlink" title="安装mysql"></a>安装mysql</h1><figure class="highlight smali"><table><tr><td class="code"><pre><span class="line">$ sudo<span class="built_in"> add-apt-repository </span>-y ppa:ondrej/mysql-5.6</span><br><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get -y install mysql-server</span><br></pre></td></tr></table></figure><p>登陆mysql创建账号</p><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ mysql -u root </span><br><span class="line">mysql&gt;create database wordpress;</span><br><span class="line">mysql&gt;grant all privileges on *.* to jceee identified by <span class="string">'123456'</span>;</span><br><span class="line">mysql&gt;flush privileges;</span><br><span class="line">mysql&gt;<span class="keyword">exit</span>;</span><br></pre></td></tr></table></figure><h1 id="u4F7F_u7528wordpress_u6D4B_u8BD5_u73AF_u5883"><a href="#u4F7F_u7528wordpress_u6D4B_u8BD5_u73AF_u5883" class="headerlink" title="使用wordpress测试环境"></a>使用wordpress测试环境</h1><h2 id="u5B89_u88C5git"><a href="#u5B89_u88C5git" class="headerlink" title="安装git"></a>安装git</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">$ apt-<span class="builtin-name">get</span> install git</span><br></pre></td></tr></table></figure><h2 id="u521B_u5EFA_u9879_u76EE_u6587_u4EF6_u5939"><a href="#u521B_u5EFA_u9879_u76EE_u6587_u4EF6_u5939" class="headerlink" title="创建项目文件夹"></a>创建项目文件夹</h2><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ sudo <span class="built_in">mkdir</span> -<span class="keyword">p</span> /<span class="keyword">opt</span>/htdocs/</span><br></pre></td></tr></table></figure><h2 id="u4E0B_u8F7Dwordpress"><a href="#u4E0B_u8F7Dwordpress" class="headerlink" title="下载wordpress"></a>下载wordpress</h2><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ sudo git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/WordPress/WordPress /<span class="keyword">opt</span>/htdocs/wordpress</span><br><span class="line">$ sudo chown -R www-data /<span class="keyword">opt</span>/htdocs</span><br></pre></td></tr></table></figure><h2 id="u589E_u52A0Nginx_u914D_u7F6E"><a href="#u589E_u52A0Nginx_u914D_u7F6E" class="headerlink" title="增加Nginx配置"></a>增加Nginx配置</h2><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ sudo <span class="keyword">vi</span> /etc/nginx/<span class="keyword">conf</span>.d/wordpress.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure><p>写入以下内容，保存并重载Nginx配置</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;    <span class="attribute">listen</span> <span class="number">80</span>;    <span class="attribute">server_name</span> www.wordpress.com;    <span class="attribute">root</span> /opt/htdocs/wordpress;    <span class="attribute">index</span> index.html index.php;    <span class="attribute">location</span> / &#123;        <span class="attribute">index</span> index.html index.php;    &#125;    <span class="attribute">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">            <span class="attribute">include</span> fastcgi.conf;                  </span><br><span class="line">            <span class="attribute">fastcgi_pass</span> unix:/var/run/php5-fpm.sock;    &#125;&#125;</span><br></pre></td></tr></table></figure><p>如果php-fpm是以TPC/IP    方式监听,如127.0.0.1:9000，则把上方</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">fastcgi_pass unix:/var/<span class="keyword">run</span><span class="bash">/php5-fpm.sock;</span></span><br></pre></td></tr></table></figure><p>改为</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">fastcgi_pass</span> 127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:9000</span>;</span><br></pre></td></tr></table></figure><h2 id="u4FEE_u6539hosts"><a href="#u4FEE_u6539hosts" class="headerlink" title="修改hosts"></a>修改hosts</h2><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">$ sudo vi <span class="regexp">/etc/</span>hosts</span><br></pre></td></tr></table></figure><p>增加以下内容并保存退出</p><figure class="highlight accesslog"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0.0.1</span> www.wordpress.com</span><br></pre></td></tr></table></figure><h2 id="u6D4B_u8BD5"><a href="#u6D4B_u8BD5" class="headerlink" title="测试"></a>测试</h2><p>在浏览器输入</p><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//www.wordpress.com</span></span><br></pre></td></tr></table></figure><p>看访问结果</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;环境：Ubuntu Linux 14.04&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;u5B89_u88C5_u8F6F_u4EF6_u4ED3_u5E93_u7BA1_u7406_u5668&quot;&gt;&lt;a href=&quot;#u5B89_u88C5
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>mysql[ON DUPLICE KEY UPDATE]</title>
    <link href="http://www.jcsama.com/2016/06/10/mysql/mysql-on-duplice-key-update/"/>
    <id>http://www.jcsama.com/2016/06/10/mysql/mysql-on-duplice-key-update/</id>
    <published>2016-06-10T09:37:51.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ON_DUPLICE_KEY_UPDATE"><a href="#ON_DUPLICE_KEY_UPDATE" class="headerlink" title="ON DUPLICE KEY UPDATE"></a>ON DUPLICE KEY UPDATE</h2><p>[ON DUPLICE KEY UPDATE] 用于INSERT语句后面，作用是在执行INSERT时，若UNIQUE索引或者PRIMARY KEY出现重复时，则在出现重复值的行执行UPDATE，否则按正常INSERT语句执行.</p><h2 id="u6D4B_u8BD5_u8868"><a href="#u6D4B_u8BD5_u8868" class="headerlink" title="测试表"></a>测试表</h2><p>表结构：</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `news` (</span><br><span class="line">  `id` int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `title` varchar(70) COLLATE utf8_unicode_ci<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `body` longtext COLLATE utf8_unicode_ci,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=InnoDB<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8 <span class="attribute">COLLATE</span>=utf8_unicode_ci;</span><br></pre></td></tr></table></figure><p>其中<code>id</code>为PRIMARY KEY<br>表数据：</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM news;</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br><span class="line">| id | title  | body  |</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br><span class="line">|  1 | title1 | NULL  |</span><br><span class="line">|  2 | title2 | body2 |</span><br><span class="line">| 12 | title1 | body3 |</span><br><span class="line">| 13 | title1 | body4 |</span><br><span class="line">| 14 | NULL   | body5 |</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br></pre></td></tr></table></figure><h2 id="u63D2_u5165_u4E00_u6761_u91CD_u590D_u6570_u636E"><a href="#u63D2_u5165_u4E00_u6761_u91CD_u590D_u6570_u636E" class="headerlink" title="插入一条重复数据"></a>插入一条重复数据</h2><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="symbol">`news`</span> (<span class="symbol">`id`</span>,<span class="symbol">`title`</span>,<span class="symbol">`body`</span>) <span class="keyword">VALUES</span> (<span class="string">'1'</span>,<span class="string">'titleTest'</span>,<span class="string">'bodyTest'</span>) <span class="keyword">ON</span> DUPLICATE <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> <span class="symbol">`title`</span>= <span class="keyword">VALUES</span>(<span class="symbol">`title`</span>),<span class="symbol">`body`</span>=<span class="keyword">VALUES</span>(<span class="symbol">`body`</span>);</span><br><span class="line">Query OK, 2 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure><p>show data:</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM news;</span><br><span class="line"><span class="code">+----+</span>-----------<span class="code">+----------+</span></span><br><span class="line">| id | title     | body     |</span><br><span class="line"><span class="code">+----+</span>-----------<span class="code">+----------+</span></span><br><span class="line">|  1 | titleTest | bodyTest |</span><br><span class="line">|  2 | title2    | body2    |</span><br><span class="line">| 12 | title1    | body3    |</span><br><span class="line">| 13 | title1    | body4    |</span><br><span class="line">| 14 | NULL      | body5    |</span><br><span class="line"><span class="code">+----+</span>-----------<span class="code">+----------+</span></span><br></pre></td></tr></table></figure><h2 id="u63D2_u5165_u591A_u6761_u91CD_u590D_u6570_u636E"><a href="#u63D2_u5165_u591A_u6761_u91CD_u590D_u6570_u636E" class="headerlink" title="插入多条重复数据"></a>插入多条重复数据</h2><figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="symbol">`news`</span> (<span class="symbol">`id`</span>,<span class="symbol">`title`</span>,<span class="symbol">`body`</span>) <span class="keyword">VALUES</span> (<span class="string">'1'</span>,<span class="string">'titleTest'</span>,<span class="string">'bodyTest'</span>),(<span class="string">'2'</span>,<span class="string">'titleTest2'</span>,<span class="string">'bodyTest2'</span>),(<span class="string">'3'</span>,<span class="string">'titleTest3'</span>,<span class="string">'bodyTest3'</span>) <span class="keyword">ON</span> DUPLICATE <span class="keyword">KEY</span> <span class="keyword">UPDATE</span> <span class="symbol">`title`</span>= <span class="keyword">VALUES</span>(<span class="symbol">`title`</span>),<span class="symbol">`body`</span>=<span class="keyword">VALUES</span>(<span class="symbol">`body`</span>);</span><br><span class="line">Query OK, 3 rows affected (0.00 sec)</span><br><span class="line">Records: 3  Duplicates: 1  Warnings: 0</span><br></pre></td></tr></table></figure><p>show data:</p><figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line">mysql&gt; SELECT <span class="symbol">*</span> FROM news;                                                                                                                                                           +----+------------+-----------+</span><br><span class="line">|<span class="string"> id </span>|<span class="string"> title      </span>|<span class="string"> body      </span>|</span><br><span class="line">+----+------------+-----------+</span><br><span class="line">|<span class="string">  1 </span>|<span class="string"> titleTest  </span>|<span class="string"> bodyTest  </span>|</span><br><span class="line">|<span class="string">  2 </span>|<span class="string"> titleTest2 </span>|<span class="string"> bodyTest2 </span>|</span><br><span class="line">|<span class="string">  3 </span>|<span class="string"> titleTest3 </span>|<span class="string"> bodyTest3 </span>|</span><br><span class="line">|<span class="string"> 12 </span>|<span class="string"> title1     </span>|<span class="string"> body3     </span>|</span><br><span class="line">|<span class="string"> 13 </span>|<span class="string"> title1     </span>|<span class="string"> body4     </span>|</span><br><span class="line">|<span class="string"> 14 </span>|<span class="string"> NULL       </span>|<span class="string"> body5     </span>|</span><br><span class="line">+----+------------+-----------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><p>因为id3不存在，所以正常INSERT了1条数据，UPDATE了2条数据</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ON_DUPLICE_KEY_UPDATE&quot;&gt;&lt;a href=&quot;#ON_DUPLICE_KEY_UPDATE&quot; class=&quot;headerlink&quot; title=&quot;ON DUPLICE KEY UPDATE&quot;&gt;&lt;/a&gt;ON DUPLICE KEY UPDATE&lt;/
      
    
    </summary>
    
      <category term="mysql" scheme="http://www.jcsama.com/categories/mysql/"/>
    
    
      <category term="mysql" scheme="http://www.jcsama.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>mysql 字符串函数</title>
    <link href="http://www.jcsama.com/2016/05/22/mysql/mysql-strimg/"/>
    <id>http://www.jcsama.com/2016/05/22/mysql/mysql-strimg/</id>
    <published>2016-05-22T14:58:20.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<h1 id="test_table"><a href="#test_table" class="headerlink" title="test table"></a>test table</h1><p>使用一个测试表：</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from news ;</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br><span class="line">| id | title  | body  |</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br><span class="line">|  1 | title1 | NULL  |</span><br><span class="line">|  2 | title2 | body2 |</span><br><span class="line">| 12 | title1 | body3 |</span><br><span class="line">| 13 | title1 | body4 |</span><br><span class="line">| 14 | NULL   | body5 |</span><br><span class="line"><span class="code">+----+</span>--------<span class="code">+-------+</span></span><br></pre></td></tr></table></figure><h1 id="concat"><a href="#concat" class="headerlink" title="concat"></a>concat</h1><p>使用方法：</p><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">CONCAT</span>(<span class="params">str1,str2,...</span>)</span></span><br></pre></td></tr></table></figure><p>返回连接参数产生的字符串，如果任何一个参数为null，则返回值为NULL.</p><p>EXAMPLE:</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select concat(id, <span class="emphasis">'-'</span>, title, <span class="emphasis">'-'</span>, body) from news ;</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br><span class="line">| concat(id, <span class="emphasis">'-'</span>, title, <span class="emphasis">'-'</span>, body) |</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br><span class="line">| NULL                              |</span><br><span class="line">| 2-title2-body2                    |</span><br><span class="line">| 12-title1-body3                   |</span><br><span class="line">| 13-title1-body4                   |</span><br><span class="line">| NULL                              |</span><br><span class="line"><span class="code">+-----------------------------------+</span></span><br></pre></td></tr></table></figure><h1 id="concat_ws"><a href="#concat_ws" class="headerlink" title="concat_ws"></a>concat_ws</h1><p>使用方法：</p><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">CONCAT_WS</span>(<span class="params">separator,str1,str2,...</span>)</span></span><br></pre></td></tr></table></figure><p>concat_ws代表concat with separator通过分隔符separator将其他参数链接起来.当分隔符为NULL时，返回值为空；而当某个参数为空时，则跳过</p><p>EXAMPLE:</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select concat<span class="emphasis">_ws('-', title, body) from news ;</span></span><br><span class="line"><span class="emphasis">+-----------------------------+</span></span><br><span class="line"><span class="emphasis">| concat_</span>ws(<span class="emphasis">'-'</span>, title, body) |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| title1                      |</span><br><span class="line">| title2-body2                |</span><br><span class="line">| title1-body3                |</span><br><span class="line">| title1-body4                |</span><br><span class="line">| body5                       |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br></pre></td></tr></table></figure><h1 id="group_concat"><a href="#group_concat" class="headerlink" title="group_concat"></a>group_concat</h1><p>使用方法</p><figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">GROUP_CONCAT([<span class="keyword">DISTINCT</span>] Field [<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">ASC</span>/<span class="keyword">DESC</span> SortField] [separator Separator])</span><br></pre></td></tr></table></figure><p>group_concat是把结果数据按字段Field连接起来，默认分隔符是<code>,</code>,可选排重[DISTINCT],可选排序[ORDER BY ASC/DESC SortField]按SortField字段排序,可选分隔符[separtor Separator]按Separator分隔。</p><p>EXAMPLE:</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select group<span class="emphasis">_concat(title) from news ;</span></span><br><span class="line"><span class="emphasis">+-----------------------------+</span></span><br><span class="line"><span class="emphasis">| group_</span>concat(title)         |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br><span class="line">| title1,title2,title1,title1 |</span><br><span class="line"><span class="code">+-----------------------------+</span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select group<span class="emphasis">_concat(distinct title order by id desc separator ';') from news ;</span></span><br><span class="line"><span class="emphasis">+-------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| group_</span>concat(distinct title order by id desc separator <span class="emphasis">';'</span>) |</span><br><span class="line"><span class="code">+-------------------------------------------------------------+</span></span><br><span class="line">| title2;title1                                               |</span><br><span class="line"><span class="code">+-------------------------------------------------------------+</span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select title,group<span class="emphasis">_concat(distinct body order by id desc separator ';') from news group by title;</span></span><br><span class="line"><span class="emphasis">+--------+------------------------------------------------------------+</span></span><br><span class="line"><span class="emphasis">| title  | group_</span>concat(distinct body order by id desc separator <span class="emphasis">';'</span>) |</span><br><span class="line"><span class="code">+--------+</span>------------------------------------------------------------+</span><br><span class="line">| NULL   | body5                                                      |</span><br><span class="line">| title1 | body4;body3                                                |</span><br><span class="line">| title2 | body2                                                      |</span><br><span class="line"><span class="code">+--------+</span>------------------------------------------------------------+</span><br></pre></td></tr></table></figure><h1 id="repeat"><a href="#repeat" class="headerlink" title="repeat"></a>repeat</h1><p>使用方法</p><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">repeat</span><span class="params">(str, repeatTime)</span></span></span><br></pre></td></tr></table></figure><p>将str循环repeatTime次</p><p>EXAMPLE</p><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select repeat(<span class="emphasis">'test'</span>, 4);</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| repeat(<span class="emphasis">'test'</span>, 4) |</span><br><span class="line"><span class="code">+-------------------+</span></span><br><span class="line">| testtesttesttest  |</span><br><span class="line"><span class="code">+-------------------+</span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="code"><pre><span class="line">mysql&gt; select repeat(body, 4) from news;</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| repeat(body, 4)      |</span><br><span class="line"><span class="code">+----------------------+</span></span><br><span class="line">| NULL                 |</span><br><span class="line">| body2body2body2body2 |</span><br><span class="line">| body3body3body3body3 |</span><br><span class="line">| body4body4body4body4 |</span><br><span class="line">| body5body5body5body5 |</span><br><span class="line"><span class="code">+----------------------+</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;test_table&quot;&gt;&lt;a href=&quot;#test_table&quot; class=&quot;headerlink&quot; title=&quot;test table&quot;&gt;&lt;/a&gt;test table&lt;/h1&gt;&lt;p&gt;使用一个测试表：&lt;/p&gt;
&lt;figure class=&quot;highlight 
      
    
    </summary>
    
      <category term="mysql" scheme="http://www.jcsama.com/categories/mysql/"/>
    
    
      <category term="mysql" scheme="http://www.jcsama.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>linux-curl</title>
    <link href="http://www.jcsama.com/2016/04/10/linux/linux-curl/"/>
    <id>http://www.jcsama.com/2016/04/10/linux/linux-curl/</id>
    <published>2016-04-10T14:26:50.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>curl是利用URL语法在命令行方式下工作的开源文件传输工具。它被广泛应用在Unix、多种Linux发行版中，并且有DOS和Win32、Win64下的移植版本。</p></blockquote><h2 id="u83B7_u53D6url_u5185_u5BB9"><a href="#u83B7_u53D6url_u5185_u5BB9" class="headerlink" title="获取url内容"></a>获取url内容</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl url</span><br></pre></td></tr></table></figure><h2 id="u4FDD_u5B58_u5185_u5BB9"><a href="#u4FDD_u5B58_u5185_u5BB9" class="headerlink" title="保存内容"></a>保存内容</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -o filename url</span><br><span class="line"><span class="variable">$ </span>curl url &gt;&gt; filename</span><br></pre></td></tr></table></figure><h2 id="u663E_u793A_u4E0B_u8F7D_u8FDB_u5EA6_u6761-_23"><a href="#u663E_u793A_u4E0B_u8F7D_u8FDB_u5EA6_u6761-_23" class="headerlink" title="显示下载进度条-#"></a>显示下载进度条<code>-#</code></h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -<span class="comment"># -o filename url</span></span><br></pre></td></tr></table></figure><h2 id="u83B7_u53D6response_header"><a href="#u83B7_u53D6response_header" class="headerlink" title="获取response header"></a>获取response header</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -i url</span><br></pre></td></tr></table></figure><h2 id="POST_u6570_u636E"><a href="#POST_u6570_u636E" class="headerlink" title="POST数据"></a>POST数据</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -d <span class="string">"key1=val1&amp;key2=val2"</span> url</span><br></pre></td></tr></table></figure><h2 id="PUT_u6587_u4EF6"><a href="#PUT_u6587_u4EF6" class="headerlink" title="PUT文件"></a>PUT文件</h2><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">$ curl -F <span class="string">"fileUpload=@/Users/jceee/Pictures/default_avatar.jpeg"</span> \</span><br><span class="line"><span class="symbol"> http:</span><span class="comment">//local.creed.com/curl</span></span><br></pre></td></tr></table></figure><h2 id="UserAgent"><a href="#UserAgent" class="headerlink" title="UserAgent"></a>UserAgent</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -A <span class="string">"USER AGENT"</span> URL</span><br></pre></td></tr></table></figure><h2 id="COOKIE"><a href="#COOKIE" class="headerlink" title="COOKIE"></a>COOKIE</h2><p>Cookie是服务器经常使用的一种记忆客户信息的方法。如果cookie被记录在了文件中，那么使用命令：</p><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">$ curl -b stored_cookies_in_file \</span><br><span class="line"><span class="symbol">http:</span><span class="comment">//local.creed.com</span></span><br></pre></td></tr></table></figure><p>可以通过请求登陆接口保存cookie文件：</p><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line">$ curl -c stored_cookies_in_file \</span><br><span class="line">-d  <span class="string">"user=username&amp;password=password"</span> \</span><br><span class="line"><span class="symbol">http:</span><span class="comment">//local.creed.com/login</span></span><br></pre></td></tr></table></figure><h2 id="REFERER"><a href="#REFERER" class="headerlink" title="REFERER"></a>REFERER</h2><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -e <span class="symbol">http:</span>/<span class="regexp">/www.baidu.com http:/</span><span class="regexp">/local.creed.com/curl</span></span><br></pre></td></tr></table></figure><h2 id="u4EE3_u7406"><a href="#u4EE3_u7406" class="headerlink" title="代理"></a>代理</h2><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">$ curl -x <span class="string">ip:</span>port <span class="string">http:</span><span class="comment">//local.creed.com/curl</span></span><br></pre></td></tr></table></figure><h2 id="u4F2A_u9020Ip"><a href="#u4F2A_u9020Ip" class="headerlink" title="伪造Ip"></a>伪造Ip</h2><p>仅限于用X-FORWARDED-FOR获取IP的地址</p><figure class="highlight livescript"><table><tr><td class="code"><pre><span class="line">$ curl -H <span class="string">"X-FORWARDED-FOR:202.103.229.11"</span><span class="string">\</span></span><br><span class="line"> -H <span class="string">"CLIENT-IP:202.103.229.11"</span><span class="string">\</span></span><br><span class="line"> <span class="string">"http://local.creed.com/curl"</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;curl是利用URL语法在命令行方式下工作的开源文件传输工具。它被广泛应用在Unix、多种Linux发行版中，并且有DOS和Win32、Win64下的移植版本。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;u83B7_u53D6url_u5
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>订阅发布者模式</title>
    <link href="http://www.jcsama.com/2016/04/04/patterns/pattern-pub-sub/"/>
    <id>http://www.jcsama.com/2016/04/04/patterns/pattern-pub-sub/</id>
    <published>2016-04-04T09:21:45.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>发布/ 订阅者模式（Publish/Subscribe）有两个参与者：发布者和订阅者。发布者创建某个信息，订阅者绑定这个信道，当发布者有消息发布至该信道时，订阅者就会接收到一个通知。最重要的一点是，发布者和订阅者是完全解耦的，彼此并不知晓对方的存在一种消息模式。</p></blockquote><h2 id="u8BA2_u9605_u53D1_u5E03_u8005"><a href="#u8BA2_u9605_u53D1_u5E03_u8005" class="headerlink" title="订阅发布者"></a>订阅发布者</h2><p>我们创建一个简单的订阅发布者，基本的4个方法：</p><ul><li>registerSubscriber 注册订阅者</li><li>removeSubscriber   订阅的取消</li><li>publish            消息推送</li><li>sortList           消息推送排序</li></ul><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DispatcherPattern</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $subList = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">registerSubscriber</span><span class="params">($name, $callback)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;subList[$name] = $callback;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">removeSubscriber</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;subList[$name])) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;subList[$name]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">publish</span><span class="params">($params)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;subList) || !is_array(<span class="keyword">$this</span>-&gt;subList)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'null'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;subList <span class="keyword">as</span> $callback) &#123;</span><br><span class="line">            call_user_func_array($callback, $params);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">sortList</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ksort(<span class="keyword">$this</span>-&gt;subList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="u8BA2_u9605_u4F53"><a href="#u8BA2_u9605_u4F53" class="headerlink" title="订阅体"></a>订阅体</h2><p>接着我们创建一个用户对象,用户对象有增加积分的功能</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addScore</span><span class="params">($score)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        printf( <span class="keyword">$this</span>-&gt;name . <span class="string">' add Score :'</span> . $score . <span class="string">"\r\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="u901A_u8FC7_u8BA2_u9605_u53D1_u5E03_u8005_u6A21_u5F0F_u4E3A_u7528_u6237_u589E_u52A0_u79EF_u5206"><a href="#u901A_u8FC7_u8BA2_u9605_u53D1_u5E03_u8005_u6A21_u5F0F_u4E3A_u7528_u6237_u589E_u52A0_u79EF_u5206" class="headerlink" title="通过订阅发布者模式为用户增加积分"></a>通过订阅发布者模式为用户增加积分</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$score = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">$dispatcher = <span class="keyword">new</span> DispatcherPattern();</span><br><span class="line"></span><br><span class="line">$dispatcher-&gt;registerSubscriber(<span class="string">'0'</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    printf( <span class="string">"this is first handle \r\n"</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$dispatcher-&gt;registerSubscriber(<span class="string">'3'</span>, <span class="keyword">array</span>(<span class="keyword">new</span> User(<span class="string">'user3'</span>), <span class="string">'addScore'</span>));</span><br><span class="line">$dispatcher-&gt;registerSubscriber(<span class="string">'1'</span>, <span class="keyword">array</span>(<span class="keyword">new</span> User(<span class="string">'user1'</span>), <span class="string">'addScore'</span>));</span><br><span class="line">$dispatcher-&gt;registerSubscriber(<span class="string">'2'</span>, <span class="keyword">array</span>(<span class="keyword">new</span> User(<span class="string">'user2'</span>), <span class="string">'addScore'</span>));</span><br><span class="line"></span><br><span class="line">$dispatcher-&gt;removeSubscriber(<span class="string">'2'</span>);</span><br><span class="line"></span><br><span class="line">$dispatcher-&gt;sortList();</span><br><span class="line">$dispatcher-&gt;publish(<span class="keyword">array</span>($score));</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span> <span class="keyword">is</span> first handle </span><br><span class="line">user1 <span class="keyword">add</span> Score :<span class="number">1</span> </span><br><span class="line">user3 <span class="keyword">add</span> Score :<span class="number">1</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;发布/ 订阅者模式（Publish/Subscribe）有两个参与者：发布者和订阅者。发布者创建某个信息，订阅者绑定这个信道，当发布者有消息发布至该信道时，订阅者就会接收到一个通知。最重要的一点是，发布者和订阅者是完全解耦的，彼此并不知晓对方的存在
      
    
    </summary>
    
      <category term="pattern" scheme="http://www.jcsama.com/categories/pattern/"/>
    
    
      <category term="pattern" scheme="http://www.jcsama.com/tags/pattern/"/>
    
      <category term="php" scheme="http://www.jcsama.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>stream_context_create</title>
    <link href="http://www.jcsama.com/2016/02/29/php/php-stream/"/>
    <id>http://www.jcsama.com/2016/02/29/php/php-stream/</id>
    <published>2016-02-29T13:06:35.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="u6D41"><a href="#u6D41" class="headerlink" title="流"></a>流</h2><p>流是PHP4.3.0中引入的特性，作用是使用统一方式处理文件、网络和数据压缩等共同一套函数和用法的操作。</p><p>每一个流都有一个协议和一个目标。指定协议和目标的方法是使用流标识符：</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">&lt;scheme&gt;<span class="symbol">://&lt;target&gt;</span></span><br></pre></td></tr></table></figure><p><scheme>是流的封装协议，<target>是流的数据源</target></scheme></p><p>如：</p><figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//api.jceee.com/services/api.php?action=test</span></span><br><span class="line"><span class="symbol">php:</span><span class="comment">//stdout</span></span><br><span class="line"><span class="symbol">file:</span><span class="comment">///etc/data.txt</span></span><br></pre></td></tr></table></figure><h2 id="stream_context_create"><a href="#stream_context_create" class="headerlink" title="stream_context_create"></a><code>stream_context_create</code></h2><p>stream_context_create用于创建流的上下文，也就是php流能接受的一系列可选参数，通过这些参数来定义流的行为，不同流的封装协议使用的上下文参数有所不同。</p><h3 id="file_get_content"><a href="#file_get_content" class="headerlink" title="file_get_content"></a>file_get_content</h3><p>我们定义一个流的参数对象，使<code>file_get_content</code>发送<code>HTTP</code>的<code>POST</code>请求。</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$requestBody = json_encode(<span class="keyword">array</span>(<span class="string">'user'</span>=&gt;<span class="string">'jceee'</span>));</span><br><span class="line">$context = stream_context_create(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'http'</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'method'</span> =&gt; <span class="string">'POST'</span>,</span><br><span class="line">        <span class="string">'header'</span> =&gt; <span class="string">"Content-Type: application/json;charset=utf-8;\r\n"</span> . </span><br><span class="line">                    <span class="string">"Content-Length: "</span> . mb_strlen($requestBody),</span><br><span class="line">        <span class="string">'content'</span> =&gt; $requestBody</span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line"></span><br><span class="line">$response = file_get_contents(<span class="string">'http://api.jceee.com/api.php'</span>, <span class="keyword">false</span>, $context);</span><br></pre></td></tr></table></figure><p>最外层的键<code>http</code>定义了流封装协议，值是协议的具体内容。通过定义<code>http</code>协议，我们就创建了一个<code>file_get_content</code>可接收的流上下文对象。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;u6D41&quot;&gt;&lt;a href=&quot;#u6D41&quot; class=&quot;headerlink&quot; title=&quot;流&quot;&gt;&lt;/a&gt;流&lt;/h2&gt;&lt;p&gt;流是PHP4.3.0中引入的特性，作用是使用统一方式处理文件、网络和数据压缩等共同一套函数和用法的操作。&lt;/p&gt;
&lt;p&gt;每一个流都有
      
    
    </summary>
    
      <category term="php" scheme="http://www.jcsama.com/categories/php/"/>
    
    
      <category term="php" scheme="http://www.jcsama.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>php高精确度数值比较-bccomp</title>
    <link href="http://www.jcsama.com/2016/02/16/php/php-bccomp/"/>
    <id>http://www.jcsama.com/2016/02/16/php/php-bccomp/</id>
    <published>2016-02-16T15:26:30.000Z</published>
    <updated>2021-08-09T06:15:05.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="bccomp"><a href="#bccomp" class="headerlink" title="bccomp"></a>bccomp</h2><p>bccomp是php的bcmath库中的方法，使用前先用phpinfo()确认一下有没有开启bcmatch库,没有则需要进行对应的编译操作。</p><p><code>bccomp($left_operand, $right_operand [, $scale = 0]);</code></p><p>参数</p><table><thead><tr><th>参数</th><th>参数描述</th><th>属性</th></tr></thead><tbody><tr><td>$left_operand</td><td>左边字符串</td><td>string</td></tr><tr><td>$right_operand</td><td>右边字符串</td><td>string</td></tr><tr><td>$scale(可不填，默认0)</td><td>返回值小数点后所需的位数</td><td>int</td></tr></tbody></table><p><code>bccomp</code>函数用于比较二个高精确度的数字。输入二个字符串，若二个字符串一样大则返回 0；若左边的数字字符串 (left operand) 比右边 (right operand) 的大则返回 +1；若左边的数字字符串比右边的小则返回 -1。scale 是一个可有可无的选项，表示返回值小数点后所需的位数:</p><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">echo '&lt;pre&gt;';</span><br><span class="line">var_dump(bccomp('1', '2'));   <span class="comment">// int(-1)</span></span><br><span class="line">var_dump(bccomp('1.<span class="number">0000</span>1', '1', <span class="number">3</span>)); <span class="comment">// int(0)</span></span><br><span class="line">var_dump(bccomp('1.<span class="number">0000</span>1', '1', <span class="number">5</span>)); <span class="comment">// int(1)</span></span><br></pre></td></tr></table></figure><h2 id="u6574_u6570_u4E0E_u6D6E_u70B9_u6570_u5BF9_u6BD4"><a href="#u6574_u6570_u4E0E_u6D6E_u70B9_u6570_u5BF9_u6BD4" class="headerlink" title="整数与浮点数对比"></a>整数与浮点数对比</h2><p>举个例子：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">'&lt;pre&gt;'</span>;</span><br><span class="line">var_dump(8160 == <span class="string">'81.6'</span> * 100);          //<span class="literal">false</span></span><br><span class="line">var_dump(<span class="string">'81.6'</span> * 100);                  //<span class="built_in">float</span>(8160)</span><br><span class="line">var_dump(<span class="string">'81.6'</span> * 100 - 8160);           //<span class="built_in">float</span>(-9.0949470177293E-13)</span><br></pre></td></tr></table></figure><p>第一个值是整数8160，第二个值是浮点81.6 跟 100相乘，虽然都是8160，但并不相等，减下来有差。这时，我们可以用bccomp来做判断：</p><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">var_dump(bccomp(<span class="number">8160</span>, '<span class="number">81.60</span>' * <span class="number">100</span>) === <span class="number">0</span>);  <span class="comment">//bool(true)</span></span><br></pre></td></tr></table></figure><p>如果没有bcmath库，也可以把第一个整数除以100，得到浮点数再进行对比</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">var_dump(<span class="number">8160</span> / <span class="number">100</span> == <span class="string">'81.6'</span>);               <span class="regexp">//bool</span>(<span class="keyword">true</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;bccomp&quot;&gt;&lt;a href=&quot;#bccomp&quot; class=&quot;headerlink&quot; title=&quot;bccomp&quot;&gt;&lt;/a&gt;bccomp&lt;/h2&gt;&lt;p&gt;bccomp是php的bcmath库中的方法，使用前先用phpinfo()确认一下有没有开启bcmatch库
      
    
    </summary>
    
      <category term="php" scheme="http://www.jcsama.com/categories/php/"/>
    
    
      <category term="php" scheme="http://www.jcsama.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>linux-man</title>
    <link href="http://www.jcsama.com/2016/02/13/linux/linux-man/"/>
    <id>http://www.jcsama.com/2016/02/13/linux/linux-man/</id>
    <published>2016-02-13T14:18:58.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>man是manual的缩写，是系统中提供相关条目参考信息的命令。</p></blockquote><p>如果需要参考命令的用法，只需要在man后加上命令名就可以得到详细说明,如</p><figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">man</span> <span class="keyword">ls</span></span><br></pre></td></tr></table></figure><p>会得到下面结果：</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">LS(1)                     BSD General Commands<span class="built_in"> Manual </span>                   LS(1)</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">     ls -- list directory contents</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">     ls [-ABCFGHLOPRSTUW@abcdefghiklmnopqrstuwx1] [file <span class="built_in">..</span>.]</span><br><span class="line"></span><br><span class="line">DESCRIPTION</span><br><span class="line">     <span class="keyword">For</span> each operand that names a file of a<span class="built_in"> type </span>other than directory, ls displays its name as well as any requested, associated information.  <span class="keyword">For</span> each operand that names a file of<span class="built_in"> type </span>directory, ls displays the names of files con-</span><br><span class="line">     tained within that directory, as well as any requested, associated information.</span><br><span class="line"></span><br><span class="line">     <span class="keyword">If</span> <span class="literal">no</span> operands are given, the contents of the current directory are displayed.  <span class="keyword">If</span> more than one operand is given, non-directory operands are displayed first; directory <span class="keyword">and</span> non-directory operands are sorted separately <span class="keyword">and</span> <span class="keyword">in</span> lexi-</span><br><span class="line">     cographical order.</span><br><span class="line"></span><br><span class="line">     The following options are available:</span><br><span class="line"></span><br><span class="line">     -@      Display extended attribute keys <span class="keyword">and</span> sizes <span class="keyword">in</span> long (-l) output.</span><br><span class="line"></span><br><span class="line">     -1      (The numeric digit ``one<span class="string">''</span>.)  Force output <span class="keyword">to</span> be one entry per line.  This is the<span class="built_in"> default </span>when output is <span class="keyword">not</span> <span class="keyword">to</span> a terminal.</span><br><span class="line"></span><br><span class="line">     -A      List all entries except <span class="keyword">for</span> . <span class="keyword">and</span> <span class="built_in">..</span>.  Always <span class="builtin-name">set</span> <span class="keyword">for</span> the super-user.</span><br><span class="line">     </span><br><span class="line">     <span class="built_in">..</span>.</span><br></pre></td></tr></table></figure><p>我们可以看到结果中显示了LS(1),(1)代表的是<code>一般用户可使用的命令</code>。在查询数据后面的数字是有意义的，它可以帮助我们了解或者直接查询相关的资料。每个数字具体含义如下：</p><table><thead><tr><th>数字</th><th>意义</th></tr></thead><tbody><tr><td>1</td><td>用户在shell环境中可以操作的命令或可执行文件</td></tr><tr><td>2</td><td>系统内核可调用的函数与工具等</td></tr><tr><td>3</td><td>一些常用的函数（function）与函数库（library），大部分为C的函数库（libc）</td></tr><tr><td>4</td><td>设备文件的说明，通常是在/dev下的文件</td></tr><tr><td>5</td><td>配置文件或者是某些文件的格式</td></tr><tr><td>6</td><td>游戏（games）</td></tr><tr><td>7</td><td>惯例与协议等，例如Linux文件系统、网络协议、ASCII code等说明</td></tr><tr><td>8</td><td>系统管理员可用的管理命令</td></tr><tr><td>9</td><td>跟kernel有关的文件</td></tr></tbody></table><p>如</p><figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">$ man <span class="number">2</span> <span class="built_in">write</span></span><br></pre></td></tr></table></figure><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">WRITE(2)                    BSD<span class="built_in"> System </span>Calls<span class="built_in"> Manual </span>                  WRITE(2)</span><br><span class="line"></span><br><span class="line">NAME</span><br><span class="line">     pwrite, write, writev -- write output</span><br><span class="line"></span><br><span class="line">LIBRARY</span><br><span class="line">     Standard C Library (libc, -lc)</span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">     #include &lt;unistd.h&gt;</span><br><span class="line"></span><br><span class="line">     ssize_t</span><br><span class="line">     pwrite(int fildes, const void <span class="number">*b</span>uf, size_t nbyte, off_t offset);</span><br><span class="line"></span><br><span class="line">     ssize_t</span><br><span class="line">     write(int fildes, const void <span class="number">*b</span>uf, size_t nbyte);</span><br><span class="line"></span><br><span class="line">     #include &lt;sys/uio.h&gt;</span><br><span class="line"></span><br><span class="line">     ssize_t</span><br><span class="line">     writev(int fildes, const struct iovec *iov, int iovcnt);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;man是manual的缩写，是系统中提供相关条目参考信息的命令。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果需要参考命令的用法，只需要在man后加上命令名就可以得到详细说明,如&lt;/p&gt;
&lt;figure class=&quot;highlight stat
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>php性状(trait)</title>
    <link href="http://www.jcsama.com/2016/02/12/php/php-trait/"/>
    <id>http://www.jcsama.com/2016/02/12/php/php-trait/</id>
    <published>2016-02-12T11:30:48.000Z</published>
    <updated>2021-10-08T04:04:41.697Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Trait是php5.4.0引入的新概念，是类的部分实现，可以混入一个或多个现有的php类中。</p></blockquote><p>性状有两个作用：</p><ul><li>表明类可以做什么（接口）</li><li>提供模块化实现（类）</li></ul><h2 id="u521B_u5EFA_u6027_u72B6"><a href="#u521B_u5EFA_u6027_u72B6" class="headerlink" title="创建性状"></a>创建性状</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">trait</span> TestTrait</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSomething</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;something;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="u4F7F_u7528_u6027_u72B6"><a href="#u4F7F_u7528_u6027_u72B6" class="headerlink" title="使用性状"></a>使用性状</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">TestTrait</span>;</span><br><span class="line">    <span class="keyword">protected</span> $something = <span class="string">'something'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line">var_dump($test-&gt;getSomething());</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * result: something</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="u62BD_u8C61_u65B9_u6CD5_2C_u9759_u6001_u65B9_u6CD5_u4E0E_u9759_u6001_u5C5E_u6027"><a href="#u62BD_u8C61_u65B9_u6CD5_2C_u9759_u6001_u65B9_u6CD5_u4E0E_u9759_u6001_u5C5E_u6027" class="headerlink" title="抽象方法,静态方法与静态属性"></a>抽象方法,静态方法与静态属性</h2><p>Trait跟类一样，也支持抽象方法的定义，还有静态方法，静态属性</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">trait</span> TestTrait</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">static</span> $num;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSomething</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;something;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showHelloWorld</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getNew</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> date(<span class="string">'Y-m-d H:i:s'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addNum</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">self</span>::$num ++;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>::$num;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">TestTrait</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $something = <span class="string">'something'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showHelloWorld</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        var_dump(<span class="string">'hello world'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line"></span><br><span class="line">$test-&gt;showHelloWorld();</span><br><span class="line"></span><br><span class="line">var_dump(Test::getNew());</span><br><span class="line"></span><br><span class="line">var_dump($test-&gt;addNum());</span><br><span class="line">var_dump($test-&gt;addNum());</span><br><span class="line">var_dump($test-&gt;addNum());</span><br><span class="line">var_dump($test-&gt;addNum());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> *result:</span></span><br><span class="line"><span class="comment"> * string(11) "hello world"</span></span><br><span class="line"><span class="comment"> * string(19) "2016-02-12 21:11:27"</span></span><br><span class="line"><span class="comment"> * int(1)</span></span><br><span class="line"><span class="comment"> * int(2)</span></span><br><span class="line"><span class="comment"> * int(3)</span></span><br><span class="line"><span class="comment"> * int(4)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="Trait_u65B9_u6CD5_u4F18_u5148_u7EA7"><a href="#Trait_u65B9_u6CD5_u4F18_u5148_u7EA7" class="headerlink" title="Trait方法优先级"></a>Trait方法优先级</h2><p>性状定义的方法的优先级是：</p><figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line">当前类中的方法 &gt; <span class="keyword">Trait</span>的方法 &gt; 基类中的方法</span><br></pre></td></tr></table></figure><h2 id="u4F7F_u7528_u591A_u4E2ATrait"><a href="#u4F7F_u7528_u591A_u4E2ATrait" class="headerlink" title="使用多个Trait"></a>使用多个Trait</h2><p>使用多个trait时，需要用<code>,</code>分隔开不同的性状</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">TestTrait</span>,<span class="title">OtherTrait</span>;</span><br><span class="line">    <span class="keyword">protected</span> $something = <span class="string">'something'</span>;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="insteadof"><a href="#insteadof" class="headerlink" title="insteadof"></a>insteadof</h2><p>两个Trait在同一个类中命名冲突，可以使用insteadof来指定方法名的使用来源</p><p>Trait1::method insteadof Trait2</p><p>insteadof是将trait2中的方法method代替成trait1中的method</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">trait</span> OtherTrait</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getSomething</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;something . <span class="string">' from other'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">showOther</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'this is other'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">TestTrait</span>, <span class="title">OtherTrait</span> &#123;</span><br><span class="line">        <span class="title">OtherTrait</span>::<span class="title">getSomething</span> <span class="title">insteadof</span> <span class="title">TestTrait</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $something = <span class="string">'something'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line">var_dump($test-&gt;getSomething());</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * result: </span></span><br><span class="line"><span class="comment"> * something from other</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="as"><a href="#as" class="headerlink" title="as"></a>as</h2><p>trait::method as public|protected|private otherMethodName</p><p>as 是给方法取一个别名,同时还可以声明方法的访问控制</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">TestTrait</span> &#123;</span><br><span class="line">        <span class="title">TestTrait</span>::<span class="title">getSomething</span> <span class="title">as</span> <span class="title">public</span> <span class="title">getSomethingPart2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $something = <span class="string">'something'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$test = <span class="keyword">new</span> Test();</span><br><span class="line">var_dump($test-&gt;getSomething());</span><br><span class="line">var_dump($test-&gt;getSomethingPart2());</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * result: </span></span><br><span class="line"><span class="comment"> * something  </span></span><br><span class="line"><span class="comment"> * something</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="u7EC4_u5408"><a href="#u7EC4_u5408" class="headerlink" title="组合"></a>组合</h2><p>trait同样可以引用其他trait,用法跟类一致.</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">trait</span> ThreeTrait</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">OtherTrait</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;Trait是php5.4.0引入的新概念，是类的部分实现，可以混入一个或多个现有的php类中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;性状有两个作用：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;表明类可以做什么（接口）&lt;/li&gt;
&lt;li&gt;提供模块化实现（类）&lt;
      
    
    </summary>
    
      <category term="php" scheme="http://www.jcsama.com/categories/php/"/>
    
    
      <category term="php" scheme="http://www.jcsama.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>linux-ps</title>
    <link href="http://www.jcsama.com/2016/02/06/linux/linux-ps/"/>
    <id>http://www.jcsama.com/2016/02/06/linux/linux-ps/</id>
    <published>2016-02-06T14:32:53.000Z</published>
    <updated>2021-08-09T06:15:05.368Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ps(Process Status)，顾名思义，是在Linux中是查看进程状态的命令。ps查看正处于Running的进程，ps aux查看所有的进程。</p></blockquote><h2 id="ps_u8FDB_u7A0B_u72B6_u6001_u7801"><a href="#ps_u8FDB_u7A0B_u72B6_u6001_u7801" class="headerlink" title="ps进程状态码"></a>ps进程状态码</h2><p>ps几种主要的状态码是:</p><ul><li>D 不可中断 uninterruptible sleep (usually IO) </li><li>R 运行 runnable (on run queue) </li><li>S 睡眠 sleeping </li><li>T 停止 traced or stopped </li><li>Z 僵死 a defunct (”zombie”) process</li></ul><h2 id="ps_u5217_u540D_u8BF4_u660E"><a href="#ps_u5217_u540D_u8BF4_u660E" class="headerlink" title="ps列名说明"></a>ps列名说明</h2><table><thead><tr><th>列名</th><th>说明</th></tr></thead><tbody><tr><td>USER</td><td>该 process 属于那个使用者账号的</td></tr><tr><td>PID</td><td>该 process 的号码</td></tr><tr><td>%CPU</td><td>该 process 使用掉的 CPU 资源百分比</td></tr><tr><td>%MEM</td><td>该 process 所占用的物理内存百分比</td></tr><tr><td>VSZ</td><td>该 process 使用掉的虚拟内存量 (Kbytes)</td></tr><tr><td>RSS</td><td>该 process 占用的固定的内存量 (Kbytes)</td></tr><tr><td>TTY</td><td>该 process 是在那个终端机上面运作，若与终端机无关，则显示 ?，另外， tty1-tty6 是本机上面的登入者程序，若为 pts/0 等等的，则表示为由网络连接进主机的程序。</td></tr><tr><td>STAT</td><td>该程序目前的状态，主要的状态可以参照上面提到的</td></tr><tr><td>START</td><td>该 process 被触发启动的时间</td></tr><tr><td>TIME</td><td>该 process 实际使用 CPU 运作的时间</td></tr><tr><td>COMMAND</td><td>该程序的实际指令</td></tr></tbody></table><h2 id="px_u53C2_u6570"><a href="#px_u53C2_u6570" class="headerlink" title="px参数"></a>px参数</h2><p>ps常用参数</p><ul><li>-e 显示所有进程</li><li>-A 所有进程均显示，与-e具有同样效果</li><li>-a 显示当前终端上所有进程，包括其他用户的进程</li><li>-u 以用户来筛选进程</li><li>x 显示没有控制终端的进程</li><li>r 显示正在运行的进程</li><li>-f 全格式</li></ul><p>还有更多参数可以参考</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>man ps</span><br></pre></td></tr></table></figure><h2 id="ps_u4F7F_u7528_u793A_u4F8B"><a href="#ps_u4F7F_u7528_u793A_u4F8B" class="headerlink" title="ps使用示例"></a>ps使用示例</h2><h3 id="u67E5_u770B_u7279_u5B9A_u7528_u6237_u8FDB_u7A0B_3A"><a href="#u67E5_u770B_u7279_u5B9A_u7528_u6237_u8FDB_u7A0B_3A" class="headerlink" title="查看特定用户进程:"></a>查看特定用户进程:</h3><p><code>ps -u &lt;用户名&gt;</code>，如查看root用户的进程</p><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>ps -u root</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">UID</span>   <span class="string">PID</span> <span class="string">TTY</span>           <span class="string">TIME</span> <span class="string">CMD</span></span><br><span class="line">   <span class="number">0</span>     <span class="number">1</span> <span class="string">??</span>        <span class="number">28</span><span class="string">:43.94</span> <span class="string">/sbin/launchd</span></span><br></pre></td></tr></table></figure><h3 id="u67E5_u770B_u6240_u6709_u8FDB_u7A0B"><a href="#u67E5_u770B_u6240_u6709_u8FDB_u7A0B" class="headerlink" title="查看所有进程"></a>查看所有进程</h3><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>ps -e</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line">PID TTY           TIME <span class="keyword">CMD</span></span><br><span class="line"><span class="bash">  1 ??        28:43.16 /sbin/launchd</span></span><br></pre></td></tr></table></figure><h3 id="u67E5_u770B_u5168_u683C_u5F0F_u7684_u5168_u8FDB_u7A0B"><a href="#u67E5_u770B_u5168_u683C_u5F0F_u7684_u5168_u8FDB_u7A0B" class="headerlink" title="查看全格式的全进程"></a>查看全格式的全进程</h3><figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line"><span class="variable">$ </span>ps -ef</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">UID</span>   <span class="string">PID</span>  <span class="string">PPID</span>   <span class="string">C</span> <span class="string">STIME</span>   <span class="string">TTY</span>           <span class="string">TIME</span> <span class="string">CMD</span></span><br><span class="line">  <span class="number">0</span>     <span class="number">1</span>     <span class="number">0</span>   <span class="number">0</span> <span class="number">24</span> <span class="number">116</span>  <span class="string">??</span>        <span class="number">28</span><span class="string">:42.63</span> <span class="string">/sbin/launchd</span></span><br></pre></td></tr></table></figure><h3 id="u67E5_u770B_u5F53_u524D_u6240_u6709_u8FDB_u7A0Bcpu_u5360_u7528_u60C5_u51B5"><a href="#u67E5_u770B_u5F53_u524D_u6240_u6709_u8FDB_u7A0Bcpu_u5360_u7528_u60C5_u51B5" class="headerlink" title="查看当前所有进程cpu占用情况"></a>查看当前所有进程cpu占用情况</h3><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line">$ ps <span class="built_in">aux</span></span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">USER</span>      <span class="string">PID</span>   <span class="string">%CPU</span> <span class="string">%MEM</span>      <span class="string">VSZ</span>    <span class="string">RSS</span>   <span class="string">TT</span>  <span class="string">STAT</span> <span class="string">STARTED</span>      <span class="string">TIME</span> <span class="string">COMMAND</span></span><br><span class="line"><span class="string">jceee</span>    <span class="number">51422</span>   <span class="number">0.1</span>  <span class="number">0.6</span>  <span class="number">3367032</span> <span class="number">107344</span>   <span class="string">??</span>  <span class="string">S</span>    <span class="string">四11下午</span>   <span class="number">1</span><span class="string">:36.91</span> <span class="string">/Applications/Robomongo.app/Contents/MacOS/Robomongo</span></span><br></pre></td></tr></table></figure><h3 id="u6839_u636E_u5173_u952E_u5B57_u67E5_u627E_u76F8_u5173_u8FDB_u7A0B"><a href="#u6839_u636E_u5173_u952E_u5B57_u67E5_u627E_u76F8_u5173_u8FDB_u7A0B" class="headerlink" title="根据关键字查找相关进程"></a>根据关键字查找相关进程</h3><p><code>ps aux | grep &lt;进程名&gt;</code></p><figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">ps</span> aux | <span class="keyword">grep</span> php-fpm</span><br></pre></td></tr></table></figure><p>result:</p><figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">jceee      <span class="number">53756</span>   <span class="number">0.0</span>  <span class="number">0.0</span>  <span class="number">2493396</span>   <span class="number">3460</span>   ??  S     5:<span class="number">53</span>下午   <span class="number">0</span>:<span class="number">00.02</span> <span class="regexp">/usr/</span>local<span class="regexp">/opt/</span>php56<span class="regexp">/sbin/</span>php-fpm --fpm-config <span class="regexp">/usr/</span>local<span class="regexp">/etc/</span>php<span class="regexp">/5.6/</span>php-fpm.conf</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;ps(Process Status)，顾名思义，是在Linux中是查看进程状态的命令。ps查看正处于Running的进程，ps aux查看所有的进程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;ps_u8FDB_u7A0B_u72B6_u
      
    
    </summary>
    
      <category term="linux" scheme="http://www.jcsama.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://www.jcsama.com/tags/linux/"/>
    
  </entry>
  
</feed>
